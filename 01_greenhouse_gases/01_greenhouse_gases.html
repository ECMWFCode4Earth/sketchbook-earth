

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Chapter 1: Greenhouses Gases - The prime suspect &#8212; Sketchbook Earth &#34;:&#34; Illustrated Climate Chronicles</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '01_greenhouse_gases/01_greenhouse_gases';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 2: It’s getting hot in here…" href="../02_temperature/02_temperature.html" />
    <link rel="prev" title="Sketchbook Earth: Illustrated Climate Chronicles" href="../intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_transparent.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo_transparent.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Sketchbook Earth: Illustrated Climate Chronicles
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 1: Greenhouse Gases - The prime suspect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_temperature/02_temperature.html">Chapter 2: It's getting hot(ter) in here</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_sea_ice/03_sea_ice.html">Chapter 3: Journey to the Frozen Sea</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ECMWFCode4Earth/sketchbook-earth" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ECMWFCode4Earth/sketchbook-earth/issues/new?title=Issue%20on%20page%20%2F01_greenhouse_gases/01_greenhouse_gases.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/01_greenhouse_gases/01_greenhouse_gases.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 1: Greenhouses Gases - The prime suspect</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generation-of-plots-based-on-the-relevant-climate-indicators-report">Generation of plots based on the relevant Climate Indicators’ report.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-1-install-import-the-necessary-packages">Section 1. Install &amp; import the necessary packages.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-2-download-data-from-cds">Section 2. Download data from CDS.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-3-calculate-the-ghg-concentrations-and-growth-rates">Section 3. Calculate the GHG concentrations and growth rates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#focus-on-sub-polar-regions">Focus on sub-polar regions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-smoothing">Temporal smoothing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-average">Spatial average</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annnual-growth-rates">Annnual growth rates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uncertainty-estimates-of-growth-rates">Uncertainty estimates of growth rates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-evolution-of-ghg-concentration-and-growth-rates">Plot the evolution of GHG concentration and growth rates.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-co2-with-ch4">Comparing CO2 with CH4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regional-spatial-averages">Regional spatial averages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-4-useful-links">Section 4. Useful links</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendices">Appendices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-a-monthly-climatology-of-the-variables">Appendix A: Monthly climatology of the variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-b-using-reanalysis-data-available-at-the-atmopshere-data-store-ads">Appendix B: Using reanalysis data available at the Atmopshere Data Store (ADS)</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-1-greenhouses-gases-the-prime-suspect">
<h1>Chapter 1: Greenhouses Gases - The prime suspect<a class="headerlink" href="#chapter-1-greenhouses-gases-the-prime-suspect" title="Permalink to this heading">#</a></h1>
<section id="generation-of-plots-based-on-the-relevant-climate-indicators-report">
<h2>Generation of plots based on <a class="reference external" href="https://climate.copernicus.eu/climate-indicators/greenhouse-gas-concentrations">the relevant Climate Indicators’ report</a>.<a class="headerlink" href="#generation-of-plots-based-on-the-relevant-climate-indicators-report" title="Permalink to this heading">#</a></h2>
<p>The ongoing climate change and the subsequent incease of earth’s temperature is  a hot topic in the recent years; a topic that has lately expanded from the purely scientific communities and touches now almost all aspects of our lives. There is much said about the role that the GreenHouse Gases (GHG) play in this climatic crisis. Let’s follow this tutorial and find out if and how the concentrations of two key GHG (carbon dioxide - CO2, and methane - CH4) changed in the last decades.</p>
<p>In this tutorial we will:</p>
<ol class="arabic simple">
<li><p>Search, download, and view data freely available in <a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/home">Climate Data Store</a> and <a class="reference external" href="https://ads.atmosphere.copernicus.eu/cdsapp#!/home">Atmosphere Data Store</a>.</p></li>
<li><p>Calculate global and regional monthly timeseries.</p></li>
<li><p>Mask the data and use spatiotemporal subsets for plotting.</p></li>
<li><p>View time series and analyse trends.</p></li>
<li><p>Create gridded plots and analyse spatial variations.</p></li>
</ol>
<style>
td, th {
   border: 1px solid white;
   border-collapse: collapse;
}
</style>
<table align="left">
  <tr>
    <th>Run the tutorial via free cloud platforms: </th>
    <!-- <th><a href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-c3s/main?labpath=reanalysis-climatology.ipynb">
        <img src = "https://mybinder.org/badge.svg" alt = "Binder"></th> -->
    <th><a href="https://kaggle.com/kernels/welcome?src=https://github.com/ECMWFCode4Earth/sketchbook-earth/blob/main/tutorials/01_greenhouse_gases/01_greenhouse_gases.ipynb">
        <img src = "https://kaggle.com/static/images/open-in-kaggle.svg" alt = "Kaggle"></th>
    <th><a href="https://colab.research.google.com/github/ECMWFCode4Earth/sketchbook-earth/blob/main/tutorials/01_greenhouse_gases/01_greenhouse_gases.ipynb">
        <img src = "https://colab.research.google.com/assets/colab-badge.svg" alt = "Colab"></th>
  </tr>
</table></section>
<section id="section-1-install-import-the-necessary-packages">
<h2>Section 1. Install &amp; import the necessary packages.<a class="headerlink" href="#section-1-install-import-the-necessary-packages" title="Permalink to this heading">#</a></h2>
<p>The first step for being able to analyse and plot the data is to download and import the necessary libraries for this tutorial. In the GitHub repository you can find the full environment that has all the libraries needed for this and the other tutorials. The environment can be installed in Linux with the simple command: <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">env</span> <span class="pre">create</span> <span class="pre">-f</span> <span class="pre">environment.yml</span></code>. This would be the best option if you use this and the rest tutorials on your local computer. If you are using this tutorial in Google Colab most of the required libraries are already preinstalled in the environment and there are only few libraries that should be downloaded.</p>
<div class="alert alert-block alert-warning">
<p><b>NOTE</b>: <br>
After you execute the below cell you might be prompted by Google Colab to “Restart the Runtime”. If this happens, please restart the runtime and move on the next cell.</p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download libraries not available in the default Google Colab environment</span>
<span class="o">%</span><span class="k">pip</span> install cdsapi

<span class="c1"># need some extra arguments for intalling cartopy otherwise some features of this library break the script if it is run in Google Colab </span>
<span class="o">%</span><span class="k">pip</span> install shapely cartopy --no-binary shapely --no-binary cartopy --force # more info at https://github.com/SciTools/cartopy/issues/1490
</pre></div>
</div>
</div>
</div>
<p>Let’s now import all the required libraries in our environment. We categorized the libraries based on that they are used for: general libraries, libraries for data analysis, and plotting libraries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># General libraries</span>
<span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">ascii_lowercase</span> <span class="k">as</span> <span class="n">ABC</span> <span class="c1"># String operations</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="c1"># date</span>
<span class="kn">import</span> <span class="nn">calendar</span> <span class="c1"># date calculations</span>
<span class="kn">import</span> <span class="nn">zipfile</span> <span class="c1"># for unzipping data</span>
<span class="kn">import</span> <span class="nn">os</span> <span class="c1"># operating system interfaces library</span>
<span class="kn">import</span> <span class="nn">cdsapi</span> <span class="c1"># CDS API</span>
<span class="kn">import</span> <span class="nn">urllib3</span> <span class="c1"># Disable warnings for data download via API</span>
<span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="c1"># Libraries for working with multidimensional arrays</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># for n-d arrays</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># for 2-d arrays (including metadata for the rows &amp; columns)</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span> <span class="c1"># for n-d arrays (including metadata for all the dimensions)</span>

<span class="c1"># Libraries for plotting and visualising data</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">cartopy.mpl.geoaxes</span>
</pre></div>
</div>
</div>
</div>
<p>The below is for having a consistent plotting across all tutorials. It <strong>will NOT work in Google Colab</strong> or other cloud services, unless you include the file (available in the Github repository) in the cloud and in the same directory as this notebook, and use the correct path, e.g.
<code class="docutils literal notranslate"><span class="pre">plt.style.use('copernicus.mplstyle')</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;../copernicus.mplstyle&#39;</span><span class="p">)</span> <span class="c1"># use the predefined matplotlib style for consistent plotting across all tutorials</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="section-2-download-data-from-cds">
<h2>Section 2. Download data from CDS.<a class="headerlink" href="#section-2-download-data-from-cds" title="Permalink to this heading">#</a></h2>
<p>Let’s create a folder were all the data will be stored.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_loc</span> <span class="o">=</span> <span class="s1">&#39;data/&#39;</span> <span class="c1"># assign folder for storing the downloaded data</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dir_loc</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># create the folder if not available</span>
</pre></div>
</div>
</div>
</div>
<p>Enter CDS API key</p>
<p>We will request data from the Climate Data Store (CDS) programmatically with the help of the CDS API. Let us make use of the option to manually set the CDS API credentials. First, you have to define two variables: <code class="docutils literal notranslate"><span class="pre">URL</span></code> and <code class="docutils literal notranslate"><span class="pre">KEY</span></code> which build together your CDS API key. The string of characters that make up your KEY include your personal User ID and CDS API key. To obtain these, first register or login to the CDS (<a class="reference external" href="http://cds.climate.copernicus.eu">http://cds.climate.copernicus.eu</a>), then visit <a class="reference external" href="https://cds.climate.copernicus.eu/api-how-to">https://cds.climate.copernicus.eu/api-how-to</a> and copy the string of characters listed after “key:”. Replace the <code class="docutils literal notranslate"><span class="pre">#########</span></code> below with that string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CDS key</span>
<span class="n">cds_url</span> <span class="o">=</span> <span class="s1">&#39;https://cds.climate.copernicus.eu/api/v2&#39;</span>
<span class="n">cds_key</span> <span class="o">=</span> <span class="s1">&#39;########&#39;</span> <span class="c1"># please add your key here the format should be as {uid}:{api-key}</span>
</pre></div>
</div>
</div>
</div>
<p>Get GHG data from the satellite products, that are available at CDS.
In CDS a user can browse all available data from the search option, and once the selected dataset is identified, one can see from the download tab the exact API request. For example in <a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-methane?tab=form">this link</a> you can see the satellite methane data. For this tutorial we used the options:</p>
<ul class="simple">
<li><p>Processing level: Level 3</p></li>
<li><p>Variable: Column-averaged dry-air mixing ratios of methane (XCH4) and related variables</p></li>
<li><p>Version: 4.4</p></li>
<li><p>Format: zip</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">cds_url</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">cds_key</span><span class="p">)</span>

<span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="s1">&#39;satellite-methane&#39;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;zip&#39;</span><span class="p">,</span>
        <span class="s1">&#39;processing_level&#39;</span><span class="p">:</span> <span class="s1">&#39;level_3&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sensor_and_algorithm&#39;</span><span class="p">:</span> <span class="s1">&#39;merged_obs4mips&#39;</span><span class="p">,</span>
        <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;4.4&#39;</span><span class="p">,</span>
        <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;xch4&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}</span><span class="s1">satellites_CH4.zip&#39;</span><span class="p">)</span>

<span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="s1">&#39;satellite-carbon-dioxide&#39;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;zip&#39;</span><span class="p">,</span>
        <span class="s1">&#39;processing_level&#39;</span><span class="p">:</span> <span class="s1">&#39;level_3&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sensor_and_algorithm&#39;</span><span class="p">:</span> <span class="s1">&#39;merged_obs4mips&#39;</span><span class="p">,</span>
        <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;4.4&#39;</span><span class="p">,</span>
        <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;xco2&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}</span><span class="s1">satellites_CO2.zip&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-06-24 20:35:51,245 INFO Welcome to the CDS
2023-06-24 20:35:51,246 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/satellite-methane
2023-06-24 20:35:51,829 INFO Request is completed
2023-06-24 20:35:51,830 INFO Downloading https://download-0012-clone.copernicus-climate.eu/cache-compute-0012/cache/data7/dataset-satellite-methane-9e933b79-0a27-4f67-bc8e-a998a1580be3.zip to data/satellites_CH4.zip (15.1M)
2023-06-24 20:36:02,142 INFO Download rate 1.5M/s   
2023-06-24 20:36:02,380 INFO Welcome to the CDS
2023-06-24 20:36:02,381 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/satellite-carbon-dioxide
2023-06-24 20:36:03,012 INFO Downloading https://download-0021.copernicus-climate.eu/cache-compute-0021/cache/data5/dataset-satellite-carbon-dioxide-b104dd8a-ea1d-4b6d-b68d-32edda46a5f1.zip to data/satellites_CO2.zip (12.2M)
2023-06-24 20:36:20,484 INFO Download rate 717.3K/s 
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result(content_length=12831918,content_type=application/zip,location=https://download-0021.copernicus-climate.eu/cache-compute-0021/cache/data5/dataset-satellite-carbon-dioxide-b104dd8a-ea1d-4b6d-b68d-32edda46a5f1.zip)
</pre></div>
</div>
</div>
</div>
<p>The data are downloaded in zip format. Let’s unzip them and rename them with an intuitive name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># unzip the satellite data, rename the file and delete the original zip</span>
<span class="k">for</span> <span class="n">i_ghg</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">,</span> <span class="s1">&#39;CH4&#39;</span><span class="p">]:</span> <span class="c1"># loop through both variables</span>
    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}</span><span class="s1">satellites_</span><span class="si">{</span><span class="n">i_ghg</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
        <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">dir_loc</span><span class="p">)</span> <span class="c1"># unzip file</span>
        <span class="n">source_file</span> <span class="o">=</span> <span class="s1">&#39;200301_202112-C3S-L3_GHG-GHG_PRODUCTS-MERGED-MERGED-OBS4MIPS-MERGED-v4.4.nc&#39;</span> <span class="c1"># the name of the unzipped file</span>
        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}{</span><span class="n">source_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}</span><span class="s1">satellites_</span><span class="si">{</span><span class="n">i_ghg</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">)</span> <span class="c1"># rename to more intuitive name</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}</span><span class="s1">satellites_</span><span class="si">{</span><span class="n">i_ghg</span><span class="si">}</span><span class="s1">.zip&#39;</span><span class="p">)</span> <span class="c1"># delete original zip file</span>

<span class="c1"># read the data with xarray</span>
<span class="n">co2_satellites</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}</span><span class="s1">satellites_CO2.nc&#39;</span><span class="p">)</span>
<span class="n">ch4_satellites</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}</span><span class="s1">satellites_CH4.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s observe how the satellite data looks like. Notice that the grid is 5 degrees lot, lat, and that the time coordinate refers to the middle day of the relevant month. There are also a lot of different variable, including the CO2 values and standard deviations related to the uncertainty.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_satellites</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                  (time: 228, bnds: 2, lat: 36, lon: 72, pressure: 10)
Coordinates:
  * time                     (time) datetime64[ns] 2003-01-16T12:00:00 ... 20...
  * lat                      (lat) float64 -87.5 -82.5 -77.5 ... 77.5 82.5 87.5
  * lon                      (lon) float64 -177.5 -172.5 -167.5 ... 172.5 177.5
Dimensions without coordinates: bnds, pressure
Data variables:
    time_bnds                (time, bnds) datetime64[ns] ...
    lat_bnds                 (lat, bnds) float64 ...
    lon_bnds                 (lon, bnds) float64 ...
    pre                      (pressure) float64 ...
    pre_bnds                 (pressure, bnds) float64 ...
    land_fraction            (lat, lon) float64 ...
    xco2                     (time, lat, lon) float32 ...
    xco2_nobs                (time, lat, lon) float64 ...
    xco2_stderr              (time, lat, lon) float32 ...
    xco2_stddev              (time, lat, lon) float32 ...
    column_averaging_kernel  (time, pressure, lat, lon) float32 ...
    vmr_profile_co2_apriori  (time, pressure, lat, lon) float32 ...
Attributes: (12/28)
    activity_id:            obs4MIPs
    comment:                Since long time, climate modellers use ensemble a...
    contact:                Maximilian Reuter (maximilian.reuter@iup.physik.u...
    Conventions:            CF-1.7 ODS-2.1
    creation_date:          2022-07-10T09:25:22Z
    data_specs_version:     2.1.0
    ...                     ...
    source_version_number:  v4.4
    title:                  C3S XCO2 v4.4
    tracking_id:            ca42b88b-c774-4a16-9ad8-a49f9a4839fd
    variable_id:            xco2
    variant_info:           Best Estimate
    variant_label:          BE</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b418fc3b-38be-4cf0-b566-ca4aa59611dd' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b418fc3b-38be-4cf0-b566-ca4aa59611dd' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 228</li><li><span>bnds</span>: 2</li><li><span class='xr-has-index'>lat</span>: 36</li><li><span class='xr-has-index'>lon</span>: 72</li><li><span>pressure</span>: 10</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-32d0345c-9e8b-44cd-897d-ee2ffeb9aa4f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-32d0345c-9e8b-44cd-897d-ee2ffeb9aa4f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2003-01-16T12:00:00 ... 2021-12-...</div><input id='attrs-cb1214fe-115f-459e-99e3-03472a72779a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cb1214fe-115f-459e-99e3-03472a72779a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e71faa3f-6b08-40f8-a4d7-5a5b26647c47' class='xr-var-data-in' type='checkbox'><label for='data-e71faa3f-6b08-40f8-a4d7-5a5b26647c47' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>comment :</span></dt><dd>time center</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2003-01-16T12:00:00.000000000&#x27;, &#x27;2003-02-15T00:00:00.000000000&#x27;,
       &#x27;2003-03-16T12:00:00.000000000&#x27;, ..., &#x27;2021-10-16T12:00:00.000000000&#x27;,
       &#x27;2021-11-16T00:00:00.000000000&#x27;, &#x27;2021-12-16T12:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-87.5 -82.5 -77.5 ... 82.5 87.5</div><input id='attrs-8cfc9f56-a896-4860-b69e-021c802b8e76' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8cfc9f56-a896-4860-b69e-021c802b8e76' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff971ec1-69d5-456c-9f8f-7108cdb4d5a6' class='xr-var-data-in' type='checkbox'><label for='data-ff971ec1-69d5-456c-9f8f-7108cdb4d5a6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>comment :</span></dt><dd>latitude center</dd></dl></div><div class='xr-var-data'><pre>array([-87.5, -82.5, -77.5, -72.5, -67.5, -62.5, -57.5, -52.5, -47.5, -42.5,
       -37.5, -32.5, -27.5, -22.5, -17.5, -12.5,  -7.5,  -2.5,   2.5,   7.5,
        12.5,  17.5,  22.5,  27.5,  32.5,  37.5,  42.5,  47.5,  52.5,  57.5,
        62.5,  67.5,  72.5,  77.5,  82.5,  87.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-177.5 -172.5 ... 172.5 177.5</div><input id='attrs-199673f0-2073-49e5-b1c6-8009d07b83b8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-199673f0-2073-49e5-b1c6-8009d07b83b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-316978c8-3c70-4724-8312-38a94748dc97' class='xr-var-data-in' type='checkbox'><label for='data-316978c8-3c70-4724-8312-38a94748dc97' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>comment :</span></dt><dd>longitude center</dd></dl></div><div class='xr-var-data'><pre>array([-177.5, -172.5, -167.5, -162.5, -157.5, -152.5, -147.5, -142.5, -137.5,
       -132.5, -127.5, -122.5, -117.5, -112.5, -107.5, -102.5,  -97.5,  -92.5,
        -87.5,  -82.5,  -77.5,  -72.5,  -67.5,  -62.5,  -57.5,  -52.5,  -47.5,
        -42.5,  -37.5,  -32.5,  -27.5,  -22.5,  -17.5,  -12.5,   -7.5,   -2.5,
          2.5,    7.5,   12.5,   17.5,   22.5,   27.5,   32.5,   37.5,   42.5,
         47.5,   52.5,   57.5,   62.5,   67.5,   72.5,   77.5,   82.5,   87.5,
         92.5,   97.5,  102.5,  107.5,  112.5,  117.5,  122.5,  127.5,  132.5,
        137.5,  142.5,  147.5,  152.5,  157.5,  162.5,  167.5,  172.5,  177.5])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8652a0dd-8a5c-421b-b3a7-ee1d34b1f19b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8652a0dd-8a5c-421b-b3a7-ee1d34b1f19b' class='xr-section-summary' >Data variables: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time, bnds)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-04e97a9a-a03a-4b6b-86d0-e93f20243e4b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-04e97a9a-a03a-4b6b-86d0-e93f20243e4b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54d24bcd-e40c-4aad-aa7c-538b05194036' class='xr-var-data-in' type='checkbox'><label for='data-54d24bcd-e40c-4aad-aa7c-538b05194036' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>comment :</span></dt><dd>time boundaries</dd></dl></div><div class='xr-var-data'><pre>[456 values with dtype=datetime64[ns]]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat_bnds</span></div><div class='xr-var-dims'>(lat, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2e7088ec-1ca8-4db5-861c-d1d4e209c87d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2e7088ec-1ca8-4db5-861c-d1d4e209c87d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-64ea477b-afa7-45f0-9f57-975b2f18b49c' class='xr-var-data-in' type='checkbox'><label for='data-64ea477b-afa7-45f0-9f57-975b2f18b49c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>comment :</span></dt><dd>latitude boundaries</dd></dl></div><div class='xr-var-data'><pre>[72 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon_bnds</span></div><div class='xr-var-dims'>(lon, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-af54062d-0e6f-4cb6-9491-486193a658dd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-af54062d-0e6f-4cb6-9491-486193a658dd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ca692307-ce76-4cf9-8d8a-3ec84087e119' class='xr-var-data-in' type='checkbox'><label for='data-ca692307-ce76-4cf9-8d8a-3ec84087e119' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>comment :</span></dt><dd>longitude boundaries</dd></dl></div><div class='xr-var-data'><pre>[144 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pre</span></div><div class='xr-var-dims'>(pressure)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-635e6f00-acfc-4f53-bee7-c25e00280e9c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-635e6f00-acfc-4f53-bee7-c25e00280e9c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a71350e1-1d1b-49d5-b1c5-3ae53096111b' class='xr-var-data-in' type='checkbox'><label for='data-a71350e1-1d1b-49d5-b1c5-3ae53096111b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>pressure</dd><dt><span>long_name :</span></dt><dd>pressure</dd><dt><span>units :</span></dt><dd>surface_pressure</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>comment :</span></dt><dd>pressure center</dd></dl></div><div class='xr-var-data'><pre>[10 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pre_bnds</span></div><div class='xr-var-dims'>(pressure, bnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-cd8aa1ac-cb46-41f2-a602-17beb21b71de' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cd8aa1ac-cb46-41f2-a602-17beb21b71de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-297555bb-51b8-4fed-b69e-b6e98f704244' class='xr-var-data-in' type='checkbox'><label for='data-297555bb-51b8-4fed-b69e-b6e98f704244' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>surface_pressure</dd><dt><span>comment :</span></dt><dd>pressure boundaries</dd></dl></div><div class='xr-var-data'><pre>[20 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>land_fraction</span></div><div class='xr-var-dims'>(lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4a08e52f-a81b-481c-bfe2-588f01a040c8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4a08e52f-a81b-481c-bfe2-588f01a040c8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-564507bc-7c53-4fcc-a0fc-5b50f703cfed' class='xr-var-data-in' type='checkbox'><label for='data-564507bc-7c53-4fcc-a0fc-5b50f703cfed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>land_area_fraction</dd><dt><span>long_name :</span></dt><dd>land area fraction</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>comment :</span></dt><dd>Land area fraction computed from GTOPO30 data available from the U.S. Geological Survey</dd></dl></div><div class='xr-var-data'><pre>[2592 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xco2</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-540780d3-d296-4b7a-9e35-41b4131ac6e8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-540780d3-d296-4b7a-9e35-41b4131ac6e8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d7bd1d0b-804a-4fdb-badf-636976316f11' class='xr-var-data-in' type='checkbox'><label for='data-d7bd1d0b-804a-4fdb-badf-636976316f11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>dry_atmosphere_mole_fraction_of_carbon_dioxide</dd><dt><span>long_name :</span></dt><dd>column-average dry-air mole fraction of atmospheric carbon dioxide</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>fill_value :</span></dt><dd>1e+20</dd><dt><span>comment :</span></dt><dd>Satellite retrieved column-average dry-air mole fraction of atmospheric carbon dioxide (XCO2)</dd></dl></div><div class='xr-var-data'><pre>[590976 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xco2_nobs</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0ced1fdb-eaed-4810-822d-0b282113879a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0ced1fdb-eaed-4810-822d-0b282113879a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-16b0fd9d-c06d-4f2c-b772-1a137a24db2f' class='xr-var-data-in' type='checkbox'><label for='data-16b0fd9d-c06d-4f2c-b772-1a137a24db2f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>1</dd><dt><span>fill_value :</span></dt><dd>0</dd><dt><span>comment :</span></dt><dd>Number of individual XCO2 L2 observations</dd></dl></div><div class='xr-var-data'><pre>[590976 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xco2_stderr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ccc8a6cf-06a7-4840-800e-f0a023d4145e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ccc8a6cf-06a7-4840-800e-f0a023d4145e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49876d50-901a-43ae-aeec-a0cbc50a6807' class='xr-var-data-in' type='checkbox'><label for='data-49876d50-901a-43ae-aeec-a0cbc50a6807' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>1</dd><dt><span>fill_value :</span></dt><dd>1e+20</dd><dt><span>comment :</span></dt><dd>Standard error of the average including single sounding noise and potential seasonal and regional biases</dd></dl></div><div class='xr-var-data'><pre>[590976 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xco2_stddev</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2bab807a-da8f-4f28-9735-59f8ef280eea' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2bab807a-da8f-4f28-9735-59f8ef280eea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-905ba1be-6911-4c51-8ef7-c58c31bb9c93' class='xr-var-data-in' type='checkbox'><label for='data-905ba1be-6911-4c51-8ef7-c58c31bb9c93' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>1</dd><dt><span>fill_value :</span></dt><dd>1e+20</dd><dt><span>comment :</span></dt><dd>Standard deviation of XCO2 L2 observations</dd></dl></div><div class='xr-var-data'><pre>[590976 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>column_averaging_kernel</span></div><div class='xr-var-dims'>(time, pressure, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a65a89cd-35d3-4b37-b52d-080e45e74417' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a65a89cd-35d3-4b37-b52d-080e45e74417' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7b22efd1-ff1c-4953-8bb4-81d1f2180893' class='xr-var-data-in' type='checkbox'><label for='data-7b22efd1-ff1c-4953-8bb4-81d1f2180893' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>1</dd><dt><span>fill_value :</span></dt><dd>1e+20</dd><dt><span>comment :</span></dt><dd>The normalized column-averaging kernel represents the sensitivity of the retrieved XCO2 to the atmospheric carbon dioxide mole fraction depending on pressure (height). All values represent layer averages within the corresponding pressure levels. Values near one are ideal and indicate that the influence of the a priori is minimal. Profiles are ordered from surface to top of atmosphere. See Product Specification Document Version 3 at www.esa-ghg-cci.org for more information.</dd></dl></div><div class='xr-var-data'><pre>[5909760 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vmr_profile_co2_apriori</span></div><div class='xr-var-dims'>(time, pressure, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e26f42fe-b74e-4153-91e8-05bb5ea165bf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e26f42fe-b74e-4153-91e8-05bb5ea165bf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-21d97904-8e0d-4b9e-985b-8ff11871b176' class='xr-var-data-in' type='checkbox'><label for='data-21d97904-8e0d-4b9e-985b-8ff11871b176' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>1</dd><dt><span>fill_value :</span></dt><dd>1e+20</dd><dt><span>comment :</span></dt><dd>A priori dry-air mole fraction profile of atmospheric carbon dioxide in ppm All values represent layer averages within the corresponding pressure levels. Profiles are ordered from surface to top of atmosphere. The a priori profile is needed to apply the XCO2 averaging kernel. See Product Specification Document Version 3 at www.esa-ghg-cci.org for more information.</dd></dl></div><div class='xr-var-data'><pre>[5909760 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1059b058-43ed-4af0-ba92-4b1f14571db3' class='xr-section-summary-in' type='checkbox'  ><label for='section-1059b058-43ed-4af0-ba92-4b1f14571db3' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-522737d1-fdf7-4982-8aff-caafad2e82d9' class='xr-index-data-in' type='checkbox'/><label for='index-522737d1-fdf7-4982-8aff-caafad2e82d9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2003-01-16 12:00:00&#x27;, &#x27;2003-02-15 00:00:00&#x27;,
               &#x27;2003-03-16 12:00:00&#x27;, &#x27;2003-04-16 00:00:00&#x27;,
               &#x27;2003-05-16 12:00:00&#x27;, &#x27;2003-06-16 00:00:00&#x27;,
               &#x27;2003-07-16 12:00:00&#x27;, &#x27;2003-08-16 12:00:00&#x27;,
               &#x27;2003-09-16 00:00:00&#x27;, &#x27;2003-10-16 12:00:00&#x27;,
               ...
               &#x27;2021-03-16 12:00:00&#x27;, &#x27;2021-04-16 00:00:00&#x27;,
               &#x27;2021-05-16 12:00:00&#x27;, &#x27;2021-06-16 00:00:00&#x27;,
               &#x27;2021-07-16 12:00:00&#x27;, &#x27;2021-08-16 12:00:00&#x27;,
               &#x27;2021-09-16 00:00:00&#x27;, &#x27;2021-10-16 12:00:00&#x27;,
               &#x27;2021-11-16 00:00:00&#x27;, &#x27;2021-12-16 12:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=228, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7654b2ca-19cb-48c6-8561-fa3b33baba94' class='xr-index-data-in' type='checkbox'/><label for='index-7654b2ca-19cb-48c6-8561-fa3b33baba94' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-87.5, -82.5, -77.5, -72.5, -67.5, -62.5, -57.5, -52.5, -47.5, -42.5,
       -37.5, -32.5, -27.5, -22.5, -17.5, -12.5,  -7.5,  -2.5,   2.5,   7.5,
        12.5,  17.5,  22.5,  27.5,  32.5,  37.5,  42.5,  47.5,  52.5,  57.5,
        62.5,  67.5,  72.5,  77.5,  82.5,  87.5],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-00a50fc2-d047-486f-bf99-804b0a435161' class='xr-index-data-in' type='checkbox'/><label for='index-00a50fc2-d047-486f-bf99-804b0a435161' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-177.5, -172.5, -167.5, -162.5, -157.5, -152.5, -147.5, -142.5, -137.5,
       -132.5, -127.5, -122.5, -117.5, -112.5, -107.5, -102.5,  -97.5,  -92.5,
        -87.5,  -82.5,  -77.5,  -72.5,  -67.5,  -62.5,  -57.5,  -52.5,  -47.5,
        -42.5,  -37.5,  -32.5,  -27.5,  -22.5,  -17.5,  -12.5,   -7.5,   -2.5,
          2.5,    7.5,   12.5,   17.5,   22.5,   27.5,   32.5,   37.5,   42.5,
         47.5,   52.5,   57.5,   62.5,   67.5,   72.5,   77.5,   82.5,   87.5,
         92.5,   97.5,  102.5,  107.5,  112.5,  117.5,  122.5,  127.5,  132.5,
        137.5,  142.5,  147.5,  152.5,  157.5,  162.5,  167.5,  172.5,  177.5],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c64abeec-af9e-42ea-bbdf-fb91e5ad3821' class='xr-section-summary-in' type='checkbox'  ><label for='section-c64abeec-af9e-42ea-bbdf-fb91e5ad3821' class='xr-section-summary' >Attributes: <span>(28)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>activity_id :</span></dt><dd>obs4MIPs</dd><dt><span>comment :</span></dt><dd>Since long time, climate modellers use ensemble approaches to calculate the
ensemble median and to estimate uncertainties of climate projections where
no ground-truth is known. Following this idea, the ensemble median
algorithm EMMA composes level 2 data of independently developed retrieval
algorithms. EMMA determines in 10x10 degree grid boxes monthly averages and
selects level 2 data of the median algorithm.</dd><dt><span>contact :</span></dt><dd>Maximilian Reuter (maximilian.reuter@iup.physik.uni-bremen.de)</dd><dt><span>Conventions :</span></dt><dd>CF-1.7 ODS-2.1</dd><dt><span>creation_date :</span></dt><dd>2022-07-10T09:25:22Z</dd><dt><span>data_specs_version :</span></dt><dd>2.1.0</dd><dt><span>frequency :</span></dt><dd>mon</dd><dt><span>further_info_url :</span></dt><dd>https://climate.copernicus.eu</dd><dt><span>grid :</span></dt><dd>L2 data gridded by arithmetic averaging</dd><dt><span>grid_label :</span></dt><dd>gn</dd><dt><span>institution :</span></dt><dd>Institute of Environmental Physics, University of Bremen</dd><dt><span>institute_id :</span></dt><dd>IUP</dd><dt><span>license :</span></dt><dd>GHG-CCI Licence: 
As condition of using this product, you agree
... to inform us prior to any publication where the data products are planned to be used. Please do this by sending us the
manuscript for review before submission for publication to ensure that our data are accurately represented.
... to offer us co-authorship for any planned peer-reviewed publication based on our data products. (For non peer-reviewed
publications it is sufficient if you add an appropriate acknowledgement.) In these instances, please contact the project management
(Michael Buchwitz (michael.buchwitz@iup.physik.uni-bremen.de) or Maximilian Reuter (maximilian.reuter@iup.physik.uni-bremen.de))
who will then forward the information to the respective retrieval teams.</dd><dt><span>nominal_resolution :</span></dt><dd>5.00x5.00 degree</dd><dt><span>product :</span></dt><dd>observations</dd><dt><span>realm :</span></dt><dd>atmos</dd><dt><span>references :</span></dt><dd>M. Reuter, H. Bösch, H. Bovensmann, A. Bril, M. Buchwitz, A. Butz,
J. P. Burrows, C. W. ODell, S. Guerlet, O. Hasekamp, J. Heymann, N. Kikuchi,
S. Oshchepkov, R. Parker, S. Pfeifer, O. Schneising, T. Yokota, and
Y. Yoshida: A joint effort to deliver satellite retrieved atmospheric CO2
concentrations for surface flux inversions: the ensemble median algorithm
EMMA. Atmospheric Chemistry and Physics, 13, 1771-1780, 2013</dd><dt><span>region :</span></dt><dd>global</dd><dt><span>source :</span></dt><dd>C3S XCO2 v4.4 (2022)</dd><dt><span>source_id :</span></dt><dd>C3S-XCO2-v4-4</dd><dt><span>source_label :</span></dt><dd>C3S-XCO2</dd><dt><span>source_type :</span></dt><dd>satellite_retrieval</dd><dt><span>source_version_number :</span></dt><dd>v4.4</dd><dt><span>title :</span></dt><dd>C3S XCO2 v4.4</dd><dt><span>tracking_id :</span></dt><dd>ca42b88b-c774-4a16-9ad8-a49f9a4839fd</dd><dt><span>variable_id :</span></dt><dd>xco2</dd><dt><span>variant_info :</span></dt><dd>Best Estimate</dd><dt><span>variant_label :</span></dt><dd>BE</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="alert alert-block alert-warning">
<p><b>NOTE</b>: <br>
The selected datasets have data up to 2021. For the ones interested in expanding the data with near-real time information, satellite measurements for the recent period are available <a class="reference external" href="http://www.iup.uni-bremen.de/~ghguser/gosat_focal.php">here</a>.</p>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &quot;quick and dirty&quot; plot of the data</span>
<span class="n">co2_satellites</span><span class="p">[</span><span class="s1">&#39;xco2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7feb59b97340&gt;
</pre></div>
</div>
<img alt="../_images/8308ad1b80e469da2ba1d42c946e61dd13a603a58b767821f23f5bb7771b46ff.png" src="../_images/8308ad1b80e469da2ba1d42c946e61dd13a603a58b767821f23f5bb7771b46ff.png" />
</div>
</div>
<p>Since we have a different variable for each GHG it is easier to combine them both in one variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># monthly sampled, spatially resolved GHG concentration in the atmosphere</span>
<span class="n">concentration</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">co2_satellites</span><span class="p">[</span><span class="s1">&#39;xco2&#39;</span><span class="p">],</span> <span class="n">ch4_satellites</span><span class="p">[</span><span class="s1">&#39;xch4&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="s1">&#39;ghg&#39;</span><span class="p">)</span>

<span class="c1"># associated standard errors</span>
<span class="n">std_error</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">co2_satellites</span><span class="p">[</span><span class="s1">&#39;xco2_stderr&#39;</span><span class="p">],</span> <span class="n">ch4_satellites</span><span class="p">[</span><span class="s1">&#39;xch4_stderr&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="s1">&#39;ghg&#39;</span><span class="p">)</span>
<span class="n">std_error</span> <span class="o">=</span> <span class="n">std_error</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;xco2&#39;</span><span class="p">,</span> <span class="s1">&#39;xch4&#39;</span><span class="p">])</span>

<span class="c1"># associated land fraction; is the same for CO2 and CH4</span>
<span class="n">land_fraction</span> <span class="o">=</span> <span class="n">co2_satellites</span><span class="p">[</span><span class="s1">&#39;land_fraction&#39;</span><span class="p">]</span>
<span class="n">is_land</span> <span class="o">=</span> <span class="n">land_fraction</span> <span class="o">&gt;=</span> <span class="mf">0.5</span>  <span class="c1"># anything with land_fraction at least 50% is considered as land</span>
<span class="n">is_land</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;is_land&#39;</span>

<span class="n">concentration</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="s1">&#39;ghg&#39;</span><span class="p">)</span> <span class="c1"># for briefly checking the variable its better to see it as &#39;dataset&#39; so that it&#39;s visually nicer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (time: 228, lat: 36, lon: 72)
Coordinates:
  * time     (time) datetime64[ns] 2003-01-16T12:00:00 ... 2021-12-16T12:00:00
  * lat      (lat) float64 -87.5 -82.5 -77.5 -72.5 -67.5 ... 72.5 77.5 82.5 87.5
  * lon      (lon) float64 -177.5 -172.5 -167.5 -162.5 ... 167.5 172.5 177.5
Data variables:
    xco2     (time, lat, lon) float32 nan nan nan nan nan ... nan nan nan nan
    xch4     (time, lat, lon) float32 nan nan nan nan nan ... nan nan nan nan
Attributes:
    standard_name:  dry_atmosphere_mole_fraction_of_carbon_dioxide
    long_name:      column-average dry-air mole fraction of atmospheric carbo...
    units:          1
    cell_methods:   time: mean
    fill_value:     1e+20
    comment:        Satellite retrieved column-average dry-air mole fraction ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-c91ea24e-4dbf-412d-8f52-ea5d37eb1041' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c91ea24e-4dbf-412d-8f52-ea5d37eb1041' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 228</li><li><span class='xr-has-index'>lat</span>: 36</li><li><span class='xr-has-index'>lon</span>: 72</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-41d4f05f-b5d4-4203-a4bc-c04ec6ffd1eb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-41d4f05f-b5d4-4203-a4bc-c04ec6ffd1eb' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2003-01-16T12:00:00 ... 2021-12-...</div><input id='attrs-08fdee65-2771-4125-8b07-7b059905c89d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-08fdee65-2771-4125-8b07-7b059905c89d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a983fdb8-d3b0-4af2-8753-5a4a21e9ea41' class='xr-var-data-in' type='checkbox'><label for='data-a983fdb8-d3b0-4af2-8753-5a4a21e9ea41' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>comment :</span></dt><dd>time center</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2003-01-16T12:00:00.000000000&#x27;, &#x27;2003-02-15T00:00:00.000000000&#x27;,
       &#x27;2003-03-16T12:00:00.000000000&#x27;, ..., &#x27;2021-10-16T12:00:00.000000000&#x27;,
       &#x27;2021-11-16T00:00:00.000000000&#x27;, &#x27;2021-12-16T12:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-87.5 -82.5 -77.5 ... 82.5 87.5</div><input id='attrs-38f3e095-d0ce-4624-93a4-6fa1e7ddc8ca' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-38f3e095-d0ce-4624-93a4-6fa1e7ddc8ca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e3a00f29-7923-4982-bc4c-26122ae6d48d' class='xr-var-data-in' type='checkbox'><label for='data-e3a00f29-7923-4982-bc4c-26122ae6d48d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>comment :</span></dt><dd>latitude center</dd></dl></div><div class='xr-var-data'><pre>array([-87.5, -82.5, -77.5, -72.5, -67.5, -62.5, -57.5, -52.5, -47.5, -42.5,
       -37.5, -32.5, -27.5, -22.5, -17.5, -12.5,  -7.5,  -2.5,   2.5,   7.5,
        12.5,  17.5,  22.5,  27.5,  32.5,  37.5,  42.5,  47.5,  52.5,  57.5,
        62.5,  67.5,  72.5,  77.5,  82.5,  87.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-177.5 -172.5 ... 172.5 177.5</div><input id='attrs-284b4e29-7ac5-49a9-8374-a87b3d7b991e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-284b4e29-7ac5-49a9-8374-a87b3d7b991e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-38b6bee7-a2a7-488b-9f5a-20b8bd47c2f0' class='xr-var-data-in' type='checkbox'><label for='data-38b6bee7-a2a7-488b-9f5a-20b8bd47c2f0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>comment :</span></dt><dd>longitude center</dd></dl></div><div class='xr-var-data'><pre>array([-177.5, -172.5, -167.5, -162.5, -157.5, -152.5, -147.5, -142.5, -137.5,
       -132.5, -127.5, -122.5, -117.5, -112.5, -107.5, -102.5,  -97.5,  -92.5,
        -87.5,  -82.5,  -77.5,  -72.5,  -67.5,  -62.5,  -57.5,  -52.5,  -47.5,
        -42.5,  -37.5,  -32.5,  -27.5,  -22.5,  -17.5,  -12.5,   -7.5,   -2.5,
          2.5,    7.5,   12.5,   17.5,   22.5,   27.5,   32.5,   37.5,   42.5,
         47.5,   52.5,   57.5,   62.5,   67.5,   72.5,   77.5,   82.5,   87.5,
         92.5,   97.5,  102.5,  107.5,  112.5,  117.5,  122.5,  127.5,  132.5,
        137.5,  142.5,  147.5,  152.5,  157.5,  162.5,  167.5,  172.5,  177.5])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8efb5557-cc75-48b2-a2e9-550ae81ac4f4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8efb5557-cc75-48b2-a2e9-550ae81ac4f4' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>xco2</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-d1e44d1a-9e9b-4f1f-9166-20da5a41c487' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d1e44d1a-9e9b-4f1f-9166-20da5a41c487' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb6c0193-4c27-42a1-8722-e95875f2e1f4' class='xr-var-data-in' type='checkbox'><label for='data-eb6c0193-4c27-42a1-8722-e95875f2e1f4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
...
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xch4</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-b4ca93d8-aeb6-47e6-be57-711b4b0a4576' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b4ca93d8-aeb6-47e6-be57-711b4b0a4576' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-384435a1-5c6b-46fa-b7bc-2bc8848d1a26' class='xr-var-data-in' type='checkbox'><label for='data-384435a1-5c6b-46fa-b7bc-2bc8848d1a26' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
...
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]],

       [[nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        ...,
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan],
        [nan, nan, nan, ..., nan, nan, nan]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-50b08ec0-12f0-4715-9a46-9b3014fa5fe7' class='xr-section-summary-in' type='checkbox'  ><label for='section-50b08ec0-12f0-4715-9a46-9b3014fa5fe7' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d8a5280c-90a1-421f-92eb-2b254ef75e9e' class='xr-index-data-in' type='checkbox'/><label for='index-d8a5280c-90a1-421f-92eb-2b254ef75e9e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2003-01-16 12:00:00&#x27;, &#x27;2003-02-15 00:00:00&#x27;,
               &#x27;2003-03-16 12:00:00&#x27;, &#x27;2003-04-16 00:00:00&#x27;,
               &#x27;2003-05-16 12:00:00&#x27;, &#x27;2003-06-16 00:00:00&#x27;,
               &#x27;2003-07-16 12:00:00&#x27;, &#x27;2003-08-16 12:00:00&#x27;,
               &#x27;2003-09-16 00:00:00&#x27;, &#x27;2003-10-16 12:00:00&#x27;,
               ...
               &#x27;2021-03-16 12:00:00&#x27;, &#x27;2021-04-16 00:00:00&#x27;,
               &#x27;2021-05-16 12:00:00&#x27;, &#x27;2021-06-16 00:00:00&#x27;,
               &#x27;2021-07-16 12:00:00&#x27;, &#x27;2021-08-16 12:00:00&#x27;,
               &#x27;2021-09-16 00:00:00&#x27;, &#x27;2021-10-16 12:00:00&#x27;,
               &#x27;2021-11-16 00:00:00&#x27;, &#x27;2021-12-16 12:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=228, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8b1f6150-3695-4cc2-a5de-f9fe361a1b2e' class='xr-index-data-in' type='checkbox'/><label for='index-8b1f6150-3695-4cc2-a5de-f9fe361a1b2e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-87.5, -82.5, -77.5, -72.5, -67.5, -62.5, -57.5, -52.5, -47.5, -42.5,
       -37.5, -32.5, -27.5, -22.5, -17.5, -12.5,  -7.5,  -2.5,   2.5,   7.5,
        12.5,  17.5,  22.5,  27.5,  32.5,  37.5,  42.5,  47.5,  52.5,  57.5,
        62.5,  67.5,  72.5,  77.5,  82.5,  87.5],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-55b92bba-bd06-4322-ac86-ae14d856bc8b' class='xr-index-data-in' type='checkbox'/><label for='index-55b92bba-bd06-4322-ac86-ae14d856bc8b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-177.5, -172.5, -167.5, -162.5, -157.5, -152.5, -147.5, -142.5, -137.5,
       -132.5, -127.5, -122.5, -117.5, -112.5, -107.5, -102.5,  -97.5,  -92.5,
        -87.5,  -82.5,  -77.5,  -72.5,  -67.5,  -62.5,  -57.5,  -52.5,  -47.5,
        -42.5,  -37.5,  -32.5,  -27.5,  -22.5,  -17.5,  -12.5,   -7.5,   -2.5,
          2.5,    7.5,   12.5,   17.5,   22.5,   27.5,   32.5,   37.5,   42.5,
         47.5,   52.5,   57.5,   62.5,   67.5,   72.5,   77.5,   82.5,   87.5,
         92.5,   97.5,  102.5,  107.5,  112.5,  117.5,  122.5,  127.5,  132.5,
        137.5,  142.5,  147.5,  152.5,  157.5,  162.5,  167.5,  172.5,  177.5],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-40a9f5ab-75ed-4696-b4eb-f0060573530d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-40a9f5ab-75ed-4696-b4eb-f0060573530d' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>dry_atmosphere_mole_fraction_of_carbon_dioxide</dd><dt><span>long_name :</span></dt><dd>column-average dry-air mole fraction of atmospheric carbon dioxide</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>fill_value :</span></dt><dd>1e+20</dd><dt><span>comment :</span></dt><dd>Satellite retrieved column-average dry-air mole fraction of atmospheric carbon dioxide (XCO2)</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Clearly, after merging the <code class="docutils literal notranslate"><span class="pre">attrs</span></code> of the <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> are not correct anymore, so let’s quickly adapt them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">concentration</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">assign_attrs</span><span class="p">({</span>
    <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;dry_atmosphere_mole_fraction&#39;</span><span class="p">,</span>
    <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;column-average dry-air mole fraction&#39;</span><span class="p">,</span>
    <span class="s1">&#39;comment&#39;</span><span class="p">:</span> <span class="s1">&#39;Satellite retrieved column-average dry-air mole fraction&#39;</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># change temporal coordinates to refer to the start of the month</span>
<span class="n">concentration</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">concentration</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m01&#39;</span><span class="p">))}</span> <span class="p">)</span> <span class="c1"># date at start of month</span>
<span class="n">std_error</span> <span class="o">=</span> <span class="n">std_error</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">std_error</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m01&#39;</span><span class="p">))}</span> <span class="p">)</span>

<span class="n">concentration</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;time&#x27; (time: 228)&gt;
array([&#x27;2003-01-01T00:00:00.000000000&#x27;, &#x27;2003-02-01T00:00:00.000000000&#x27;,
       &#x27;2003-03-01T00:00:00.000000000&#x27;, ..., &#x27;2021-10-01T00:00:00.000000000&#x27;,
       &#x27;2021-11-01T00:00:00.000000000&#x27;, &#x27;2021-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)
Coordinates:
  * time     (time) datetime64[ns] 2003-01-01 2003-02-01 ... 2021-12-01</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'time'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 228</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-2105e45a-0c90-4741-b171-40d63e3e14e2' class='xr-array-in' type='checkbox' checked><label for='section-2105e45a-0c90-4741-b171-40d63e3e14e2' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>2003-01-01 2003-02-01 2003-03-01 ... 2021-10-01 2021-11-01 2021-12-01</span></div><div class='xr-array-data'><pre>array([&#x27;2003-01-01T00:00:00.000000000&#x27;, &#x27;2003-02-01T00:00:00.000000000&#x27;,
       &#x27;2003-03-01T00:00:00.000000000&#x27;, ..., &#x27;2021-10-01T00:00:00.000000000&#x27;,
       &#x27;2021-11-01T00:00:00.000000000&#x27;, &#x27;2021-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></div></li><li class='xr-section-item'><input id='section-601bac4d-649d-477b-ae07-2174b06c1db8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-601bac4d-649d-477b-ae07-2174b06c1db8' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2003-01-01 ... 2021-12-01</div><input id='attrs-e5ad9229-b7a4-4a23-a1fa-cc46dc0bf807' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e5ad9229-b7a4-4a23-a1fa-cc46dc0bf807' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-299dbe86-f81f-496e-a23b-5721621ef593' class='xr-var-data-in' type='checkbox'><label for='data-299dbe86-f81f-496e-a23b-5721621ef593' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2003-01-01T00:00:00.000000000&#x27;, &#x27;2003-02-01T00:00:00.000000000&#x27;,
       &#x27;2003-03-01T00:00:00.000000000&#x27;, ..., &#x27;2021-10-01T00:00:00.000000000&#x27;,
       &#x27;2021-11-01T00:00:00.000000000&#x27;, &#x27;2021-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4822d4b2-6b00-4ea8-ae72-8435e455760a' class='xr-section-summary-in' type='checkbox'  ><label for='section-4822d4b2-6b00-4ea8-ae72-8435e455760a' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bfa7caf5-7821-4f07-a61a-d0829eb077c7' class='xr-index-data-in' type='checkbox'/><label for='index-bfa7caf5-7821-4f07-a61a-d0829eb077c7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2003-01-01&#x27;, &#x27;2003-02-01&#x27;, &#x27;2003-03-01&#x27;, &#x27;2003-04-01&#x27;,
               &#x27;2003-05-01&#x27;, &#x27;2003-06-01&#x27;, &#x27;2003-07-01&#x27;, &#x27;2003-08-01&#x27;,
               &#x27;2003-09-01&#x27;, &#x27;2003-10-01&#x27;,
               ...
               &#x27;2021-03-01&#x27;, &#x27;2021-04-01&#x27;, &#x27;2021-05-01&#x27;, &#x27;2021-06-01&#x27;,
               &#x27;2021-07-01&#x27;, &#x27;2021-08-01&#x27;, &#x27;2021-09-01&#x27;, &#x27;2021-10-01&#x27;,
               &#x27;2021-11-01&#x27;, &#x27;2021-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=228, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9490bd28-cda4-419e-bc17-1f33edd8000e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9490bd28-cda4-419e-bc17-1f33edd8000e' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="section-3-calculate-the-ghg-concentrations-and-growth-rates">
<h2>Section 3. Calculate the GHG concentrations and growth rates<a class="headerlink" href="#section-3-calculate-the-ghg-concentrations-and-growth-rates" title="Permalink to this heading">#</a></h2>
<p>We will calculate the monthly averages of global and regional GHG concentration, as well as a 12-month temporally-smoothed global average for removing possible seasonal effects.
As there are many steps in the process we will split this part in segments.</p>
<p>Note on values over ocean: water is a bad reflector in the short-wave infrared spectral region and requires a specific observation mode. Not all satellites that this dataset is based on have this specific mode which is why we consider <strong>values over land only</strong> in the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">concentration</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_land</span><span class="p">)</span>
<span class="n">std_error</span> <span class="o">=</span> <span class="n">std_error</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_land</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="focus-on-sub-polar-regions">
<h3>Focus on sub-polar regions<a class="headerlink" href="#focus-on-sub-polar-regions" title="Permalink to this heading">#</a></h3>
<p>In this particular example, we focus on <strong>latitudes between 60N and 60S</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_of_interest</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Global&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)},</span>
    <span class="s1">&#39;Northern Hemishpere&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)},</span>
    <span class="s1">&#39;Southern Hemisphere&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">)}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="temporal-smoothing">
<h3>Temporal smoothing<a class="headerlink" href="#temporal-smoothing" title="Permalink to this heading">#</a></h3>
<p>Now we can define the auxiliary data needed for the temporal smoothing. Let’s be very precise and take into consideration that each month has different number of days.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoothed_n_months</span> <span class="o">=</span> <span class="mi">12</span> <span class="c1"># months used for the temporal smoothing</span>

<span class="c1"># get number of days for each month</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">values</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span>
<span class="n">days_month</span> <span class="o">=</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">monthrange</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span> <span class="n">mn</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">yr</span><span class="p">,</span> <span class="n">mn</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">months</span><span class="p">)]</span>

<span class="c1"># temporal weights as xarray object (helps with automated alignment of the data for the calculations at the next steps)</span>
<span class="n">weights_temporal</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span><span class="o">+</span><span class="n">days_month</span> 

<span class="c1"># weights should be changed to NaN for the cells that hava NaN in the relevant month</span>
<span class="n">weights_temporal</span> <span class="o">=</span> <span class="n">weights_temporal</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">concentration</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>It’s time to calculate the temporally smoothed data for each grid cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rolling sum of the product of satellite measurements with the days per month</span>
<span class="n">temp_smoothed</span> <span class="o">=</span> <span class="p">(</span><span class="n">concentration</span><span class="o">*</span><span class="n">weights_temporal</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">smoothed_n_months</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="c1"># min_periods=1 is needed, so that even if there is only 1 non-NaN value, there will be a result and not NaN</span>

<span class="c1"># divide with total number of days for getting the final weighted temporally-smoothed timeseries</span>
<span class="n">temp_smoothed</span> <span class="o">=</span> <span class="n">temp_smoothed</span><span class="o">/</span><span class="n">weights_temporal</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">smoothed_n_months</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="spatial-average">
<h3>Spatial average<a class="headerlink" href="#spatial-average" title="Permalink to this heading">#</a></h3>
<p>Moving on with the spatial averaging now.</p>
<p>The data are projected in lat/lon system. This system does not have equal areas for all grid cells, but as we move closer to the poles, the areas of the cells are reducing. These differences can be accounted when weighting the cells with the cosine of their latitude.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weights_spatial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">concentration</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># weights for CO2 satellite data</span>
<span class="n">weights_spatial</span> <span class="c1"># the clip function above is for reassuring that all values will be between 0-1 regardless of the  of machine&#39;s precision</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;lat&#x27; (lat: 36)&gt;
array([0.04361939, 0.13052619, 0.21643961, 0.3007058 , 0.38268343,
       0.46174861, 0.53729961, 0.60876143, 0.67559021, 0.73727734,
       0.79335334, 0.84339145, 0.88701083, 0.92387953, 0.95371695,
       0.97629601, 0.99144486, 0.99904822, 0.99904822, 0.99144486,
       0.97629601, 0.95371695, 0.92387953, 0.88701083, 0.84339145,
       0.79335334, 0.73727734, 0.67559021, 0.60876143, 0.53729961,
       0.46174861, 0.38268343, 0.3007058 , 0.21643961, 0.13052619,
       0.04361939])
Coordinates:
  * lat      (lat) float64 -87.5 -82.5 -77.5 -72.5 -67.5 ... 72.5 77.5 82.5 87.5
Attributes:
    standard_name:  latitude
    long_name:      latitude
    units:          degrees_north
    axis:           Y
    comment:        latitude center</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'lat'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 36</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-24c64837-8850-472e-ad7d-a538070edb9e' class='xr-array-in' type='checkbox' checked><label for='section-24c64837-8850-472e-ad7d-a538070edb9e' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.04362 0.1305 0.2164 0.3007 0.3827 ... 0.3007 0.2164 0.1305 0.04362</span></div><div class='xr-array-data'><pre>array([0.04361939, 0.13052619, 0.21643961, 0.3007058 , 0.38268343,
       0.46174861, 0.53729961, 0.60876143, 0.67559021, 0.73727734,
       0.79335334, 0.84339145, 0.88701083, 0.92387953, 0.95371695,
       0.97629601, 0.99144486, 0.99904822, 0.99904822, 0.99144486,
       0.97629601, 0.95371695, 0.92387953, 0.88701083, 0.84339145,
       0.79335334, 0.73727734, 0.67559021, 0.60876143, 0.53729961,
       0.46174861, 0.38268343, 0.3007058 , 0.21643961, 0.13052619,
       0.04361939])</pre></div></div></li><li class='xr-section-item'><input id='section-917c2a04-dfab-48bf-9886-4fb97883e1f1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-917c2a04-dfab-48bf-9886-4fb97883e1f1' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-87.5 -82.5 -77.5 ... 82.5 87.5</div><input id='attrs-8eb78cc6-5963-4e9f-9c13-f3755a8aa352' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8eb78cc6-5963-4e9f-9c13-f3755a8aa352' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-344139f2-88ea-4894-a8f9-3a870e550504' class='xr-var-data-in' type='checkbox'><label for='data-344139f2-88ea-4894-a8f9-3a870e550504' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>comment :</span></dt><dd>latitude center</dd></dl></div><div class='xr-var-data'><pre>array([-87.5, -82.5, -77.5, -72.5, -67.5, -62.5, -57.5, -52.5, -47.5, -42.5,
       -37.5, -32.5, -27.5, -22.5, -17.5, -12.5,  -7.5,  -2.5,   2.5,   7.5,
        12.5,  17.5,  22.5,  27.5,  32.5,  37.5,  42.5,  47.5,  52.5,  57.5,
        62.5,  67.5,  72.5,  77.5,  82.5,  87.5])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2dac5f96-fc5c-4486-97cf-1c0f38afea18' class='xr-section-summary-in' type='checkbox'  ><label for='section-2dac5f96-fc5c-4486-97cf-1c0f38afea18' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-37209082-b7a1-4048-b3db-d0ea25a00a29' class='xr-index-data-in' type='checkbox'/><label for='index-37209082-b7a1-4048-b3db-d0ea25a00a29' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-87.5, -82.5, -77.5, -72.5, -67.5, -62.5, -57.5, -52.5, -47.5, -42.5,
       -37.5, -32.5, -27.5, -22.5, -17.5, -12.5,  -7.5,  -2.5,   2.5,   7.5,
        12.5,  17.5,  22.5,  27.5,  32.5,  37.5,  42.5,  47.5,  52.5,  57.5,
        62.5,  67.5,  72.5,  77.5,  82.5,  87.5],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2605a313-8879-4dda-94b9-77973ebf3c3f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2605a313-8879-4dda-94b9-77973ebf3c3f' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>comment :</span></dt><dd>latitude center</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Let’s now combine both data (actual and temporally smoothed) in one dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">area_weighted_spatial_average</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate area-weighted spatial average of data</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : xarray.DataArray</span>
<span class="sd">        DataArray with lat and lon coordinates</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    xarray.DataArray</span>
<span class="sd">        Area-weighted spatial average</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># weights</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>


<span class="n">spatial_aver</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">boundaries</span> <span class="ow">in</span> <span class="n">region_of_interest</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">conc</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">boundaries</span><span class="p">)</span> <span class="c1"># select the region of interest</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">temp_smoothed</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">boundaries</span><span class="p">)</span>

    <span class="c1"># spatial average of the raw data</span>
    <span class="n">sa</span> <span class="o">=</span> <span class="n">area_weighted_spatial_average</span><span class="p">(</span><span class="n">conc</span><span class="p">)</span>
    <span class="n">sa</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;raw&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>

    <span class="c1"># spatial average of the temporally smoothed data</span>
    <span class="n">sa_smoothed</span> <span class="o">=</span> <span class="n">area_weighted_spatial_average</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="n">sa_smoothed</span> <span class="o">=</span> <span class="n">sa_smoothed</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;smoothed&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>

    <span class="n">sa</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">sa</span><span class="p">,</span> <span class="n">sa_smoothed</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="c1"># combine the monthly and smoothed data in 1 dataset</span>
    <span class="n">sa</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="n">region</span><span class="p">})</span> <span class="c1"># add region as coordinate</span>

    <span class="n">spatial_aver</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sa</span><span class="p">)</span>

<span class="n">spatial_aver</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">spatial_aver</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">)</span>
<span class="n">spatial_aver</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="s1">&#39;ghg&#39;</span><span class="p">)</span> <span class="c1"># remember that we use &#39;dataset&#39; object instead of &#39;dataarray&#39; so that the information are visually nicer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (region: 3, type: 2, time: 228)
Coordinates:
  * time     (time) datetime64[ns] 2003-01-01 2003-02-01 ... 2021-12-01
  * type     (type) &lt;U8 &#x27;raw&#x27; &#x27;smoothed&#x27;
  * region   (region) &lt;U19 &#x27;Global&#x27; &#x27;Northern Hemishpere&#x27; &#x27;Southern Hemisphere&#x27;
Data variables:
    xco2     (region, type, time) float64 0.0003758 0.0003765 ... 0.000414
    xch4     (region, type, time) float64 1.749e-06 1.742e-06 ... 1.856e-06</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d26ab3aa-4bc9-4875-8d7f-de08298801c0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d26ab3aa-4bc9-4875-8d7f-de08298801c0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>region</span>: 3</li><li><span class='xr-has-index'>type</span>: 2</li><li><span class='xr-has-index'>time</span>: 228</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-3b971fdc-b745-4b8d-a8df-3ec32c9f6664' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3b971fdc-b745-4b8d-a8df-3ec32c9f6664' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2003-01-01 ... 2021-12-01</div><input id='attrs-8140c05a-2eca-4a24-9674-0f27651ff222' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8140c05a-2eca-4a24-9674-0f27651ff222' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3991ee13-fe0b-47a7-a27a-62dc4c9db52d' class='xr-var-data-in' type='checkbox'><label for='data-3991ee13-fe0b-47a7-a27a-62dc4c9db52d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2003-01-01T00:00:00.000000000&#x27;, &#x27;2003-02-01T00:00:00.000000000&#x27;,
       &#x27;2003-03-01T00:00:00.000000000&#x27;, ..., &#x27;2021-10-01T00:00:00.000000000&#x27;,
       &#x27;2021-11-01T00:00:00.000000000&#x27;, &#x27;2021-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>type</span></div><div class='xr-var-dims'>(type)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;raw&#x27; &#x27;smoothed&#x27;</div><input id='attrs-2f85d5c4-deec-4ee6-b2c7-75fd3dbb4732' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2f85d5c4-deec-4ee6-b2c7-75fd3dbb4732' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2b52075f-99a5-44d3-82e5-33a38cf20936' class='xr-var-data-in' type='checkbox'><label for='data-2b52075f-99a5-44d3-82e5-33a38cf20936' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;raw&#x27;, &#x27;smoothed&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>region</span></div><div class='xr-var-dims'>(region)</div><div class='xr-var-dtype'>&lt;U19</div><div class='xr-var-preview xr-preview'>&#x27;Global&#x27; ... &#x27;Southern Hemisphere&#x27;</div><input id='attrs-8476b0fb-f5e3-40e2-a906-72dd29e0cb21' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8476b0fb-f5e3-40e2-a906-72dd29e0cb21' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f19b36e1-38a5-4766-a3a1-966cd1c60509' class='xr-var-data-in' type='checkbox'><label for='data-f19b36e1-38a5-4766-a3a1-966cd1c60509' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Global&#x27;, &#x27;Northern Hemishpere&#x27;, &#x27;Southern Hemisphere&#x27;], dtype=&#x27;&lt;U19&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-46e09635-28f8-4fbb-978c-6aa5ee20a7ed' class='xr-section-summary-in' type='checkbox'  checked><label for='section-46e09635-28f8-4fbb-978c-6aa5ee20a7ed' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>xco2</span></div><div class='xr-var-dims'>(region, type, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0003758 0.0003765 ... 0.000414</div><input id='attrs-0cf054a7-d863-47cf-8cf1-8e401beb71ce' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0cf054a7-d863-47cf-8cf1-8e401beb71ce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-35e718c4-7ca8-4ad0-8c4a-c712c3984003' class='xr-var-data-in' type='checkbox'><label for='data-35e718c4-7ca8-4ad0-8c4a-c712c3984003' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.0003758 , 0.00037646, 0.00037641, ..., 0.00041372,
         0.00041494, 0.00041572],
        [0.00037613, 0.00037571, 0.00037533, ..., 0.00041455,
         0.00041428, 0.00041396]],

       [[0.00037637, 0.00037736, 0.00037781, ..., 0.00041368,
         0.00041517, 0.00041642],
        [0.00037702, 0.0003764 , 0.00037588, ..., 0.00041492,
         0.00041448, 0.00041395]],

       [[0.00037454, 0.00037484, 0.00037387, ..., 0.00041382,
         0.00041428, 0.00041397],
        [0.00037398, 0.00037409, 0.00037404, ..., 0.00041363,
         0.00041378, 0.00041398]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xch4</span></div><div class='xr-var-dims'>(region, type, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.749e-06 1.742e-06 ... 1.856e-06</div><input id='attrs-69ec5f75-784d-4051-a564-782736e1cd6d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-69ec5f75-784d-4051-a564-782736e1cd6d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e703e82b-a8af-4043-a8d0-1d6e60bb2d01' class='xr-var-data-in' type='checkbox'><label for='data-e703e82b-a8af-4043-a8d0-1d6e60bb2d01' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[1.74943372e-06, 1.74151359e-06, 1.74311989e-06, ...,
         1.89276662e-06, 1.89320705e-06, 1.89056270e-06],
        [1.74613202e-06, 1.74720902e-06, 1.74887263e-06, ...,
         1.88225698e-06, 1.88346343e-06, 1.88548492e-06]],

       [[1.76050057e-06, 1.75097184e-06, 1.75071150e-06, ...,
         1.90728734e-06, 1.90937121e-06, 1.90675415e-06],
        [1.75377608e-06, 1.75545558e-06, 1.75780173e-06, ...,
         1.89299084e-06, 1.89466140e-06, 1.89733912e-06]],

       [[1.72989829e-06, 1.72280307e-06, 1.72550828e-06, ...,
         1.85297131e-06, 1.84980800e-06, 1.84738860e-06],
        [1.72706684e-06, 1.72664113e-06, 1.72660238e-06, ...,
         1.85548543e-06, 1.85553437e-06, 1.85573701e-06]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a43cbe27-a33f-4ed7-95ec-d547bf48cbca' class='xr-section-summary-in' type='checkbox'  ><label for='section-a43cbe27-a33f-4ed7-95ec-d547bf48cbca' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3f36edf7-fa31-4ce4-8b21-7229b4cd6eef' class='xr-index-data-in' type='checkbox'/><label for='index-3f36edf7-fa31-4ce4-8b21-7229b4cd6eef' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2003-01-01&#x27;, &#x27;2003-02-01&#x27;, &#x27;2003-03-01&#x27;, &#x27;2003-04-01&#x27;,
               &#x27;2003-05-01&#x27;, &#x27;2003-06-01&#x27;, &#x27;2003-07-01&#x27;, &#x27;2003-08-01&#x27;,
               &#x27;2003-09-01&#x27;, &#x27;2003-10-01&#x27;,
               ...
               &#x27;2021-03-01&#x27;, &#x27;2021-04-01&#x27;, &#x27;2021-05-01&#x27;, &#x27;2021-06-01&#x27;,
               &#x27;2021-07-01&#x27;, &#x27;2021-08-01&#x27;, &#x27;2021-09-01&#x27;, &#x27;2021-10-01&#x27;,
               &#x27;2021-11-01&#x27;, &#x27;2021-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=228, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>type</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-73ce4cfd-b5fa-44bd-993d-3617e7f6b20e' class='xr-index-data-in' type='checkbox'/><label for='index-73ce4cfd-b5fa-44bd-993d-3617e7f6b20e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;raw&#x27;, &#x27;smoothed&#x27;], dtype=&#x27;object&#x27;, name=&#x27;type&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>region</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-93d82eda-6e15-4e10-aa46-212c3f1fe1f1' class='xr-index-data-in' type='checkbox'/><label for='index-93d82eda-6e15-4e10-aa46-212c3f1fe1f1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;Global&#x27;, &#x27;Northern Hemishpere&#x27;, &#x27;Southern Hemisphere&#x27;], dtype=&#x27;object&#x27;, name=&#x27;region&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f532610f-7cb0-479e-96f6-e50e8873a011' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f532610f-7cb0-479e-96f6-e50e8873a011' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Maybe you noticed that we first did the temporal smoothing for each grid cell, and then performed the global average. This requires more computations from doing first the global average and then the temporal smoothing on the derived single global timeseries. The former though is the correct one, and although the results are very similar (<code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">to</span> <span class="pre">do</span> <span class="pre">task</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">ones</span> <span class="pre">interested</span></code>), the differences can considerably increase for datasets that have missing values at different grid cells each time step, as in our case with the satellite data.</p>
</section>
<section id="annnual-growth-rates">
<h3>Annnual growth rates<a class="headerlink" href="#annnual-growth-rates" title="Permalink to this heading">#</a></h3>
<p>The computation of growth rates and associated uncertainties is based on Buchwitz et al. (2018).  The monthly sampled annual growth rates are computed as the difference between two monthly XCO2 values corresponding to the same month (e.g. January) but different years (e.g. 2004 and 2005). For example, the first data point is the difference of the April 2004 XCO2 value minus the April 2003 XCO2 value. The second data point corresponds to May 2004 minus May 2003, etc. The time difference between the monthly XCO2 pairs is always 1 year and the time assigned to each XCO2 difference is the time in the middle of that year. Therefore, the time series of growth rates starts 6 months later and ends 6 months earlier compared to the time series of XCO2 concentrations. Each XCO2 difference therefore corresponds to an estimate of the XCO2 annual growth rate and the position on the time axis corresponds to the middle of the corresponding 1-year time period.</p>
<div class="alert alert-block alert-success">
    <b>NOTE</b>: <br>
    As explained in Buchwitz et al. (2017)<sup>5</sup> (see discussion of their Fig. 6.1.1.1), the underlying SCIAMACHY BESD v02.01.02 XCO2 data product apparently suffers from an approximately 1 ppm high bias in the first few months of 2003. As a consequence, these months should be removed for a less biased computation of the growth rates. For the sake of simplicity, we will refrain from doing so in this tutorial.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># accoridng to buchwitz 2018 the underlying SCIAMACHY BESD v02.01.02 XCO2 data product apparently suffers from an bias in the first 3 months of 2003</span>
<span class="c1"># xco2.loc[xco2.time.isin(xco2.isel(time=slice(0, 3)).time)] = np.nan</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># monthly sampled annual growth rates</span>
<span class="n">growth_rates</span> <span class="o">=</span> <span class="n">spatial_aver</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">time</span><span class="o">=-</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">spatial_aver</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">growth_rates</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="s1">&#39;ghg&#39;</span><span class="p">)</span> <span class="c1"># remember that we use &#39;dataset&#39; object instead of &#39;dataarray&#39; so that the information are visually nicer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (region: 3, time: 228)
Coordinates:
  * time     (time) datetime64[ns] 2003-01-01 2003-02-01 ... 2021-12-01
  * region   (region) &lt;U19 &#x27;Global&#x27; &#x27;Northern Hemishpere&#x27; &#x27;Southern Hemisphere&#x27;
Data variables:
    xco2     (region, time) float64 nan nan nan nan nan ... nan nan nan nan nan
    xch4     (region, time) float64 nan nan nan nan nan ... nan nan nan nan nan</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-de4e08b7-e8ed-43a2-b94c-089041fd1017' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-de4e08b7-e8ed-43a2-b94c-089041fd1017' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>region</span>: 3</li><li><span class='xr-has-index'>time</span>: 228</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7313f90e-95f8-45f6-8c1c-7e2de3b79f38' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7313f90e-95f8-45f6-8c1c-7e2de3b79f38' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2003-01-01 ... 2021-12-01</div><input id='attrs-4f3cd126-649f-431d-a532-91298dc2386c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4f3cd126-649f-431d-a532-91298dc2386c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9bc45a8d-fb08-4312-a4ad-c1c749040583' class='xr-var-data-in' type='checkbox'><label for='data-9bc45a8d-fb08-4312-a4ad-c1c749040583' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2003-01-01T00:00:00.000000000&#x27;, &#x27;2003-02-01T00:00:00.000000000&#x27;,
       &#x27;2003-03-01T00:00:00.000000000&#x27;, ..., &#x27;2021-10-01T00:00:00.000000000&#x27;,
       &#x27;2021-11-01T00:00:00.000000000&#x27;, &#x27;2021-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>region</span></div><div class='xr-var-dims'>(region)</div><div class='xr-var-dtype'>&lt;U19</div><div class='xr-var-preview xr-preview'>&#x27;Global&#x27; ... &#x27;Southern Hemisphere&#x27;</div><input id='attrs-98e60987-e0b7-4ca0-84f2-90b176341eb6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-98e60987-e0b7-4ca0-84f2-90b176341eb6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1d1f895-31c5-485b-beea-6f183ad88a37' class='xr-var-data-in' type='checkbox'><label for='data-d1d1f895-31c5-485b-beea-6f183ad88a37' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Global&#x27;, &#x27;Northern Hemishpere&#x27;, &#x27;Southern Hemisphere&#x27;], dtype=&#x27;&lt;U19&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a346fdee-1579-4adc-ae9e-42a3043aa11e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a346fdee-1579-4adc-ae9e-42a3043aa11e' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>xco2</span></div><div class='xr-var-dims'>(region, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-04204b92-1a77-47b5-96e0-0f43374da9c5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-04204b92-1a77-47b5-96e0-0f43374da9c5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6ab02217-7b9f-48f8-9171-f366deca736f' class='xr-var-data-in' type='checkbox'><label for='data-6ab02217-7b9f-48f8-9171-f366deca736f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[            nan,             nan,             nan,
                    nan,             nan,             nan,
         7.56929042e-07,  3.80234147e-07,  1.19665669e-06,
         1.40380841e-06,  2.07118785e-06,  2.05906534e-06,
         1.77149379e-06,  1.99774010e-06,  1.41116740e-06,
         1.02365689e-06,  9.95101601e-07,  1.38846649e-06,
         1.43425672e-06,  1.56034449e-06,  1.75200807e-06,
         2.08774509e-06,  1.78437467e-06,  1.80374322e-06,
         1.67230327e-06,  2.24973783e-06,  2.32203054e-06,
         2.56074835e-06,  2.37305872e-06,  2.26238204e-06,
         2.11913452e-06,  3.12683395e-06,  1.84921720e-06,
         2.27051924e-06,  2.08958052e-06,  1.99491632e-06,
         2.37144838e-06,  2.30137021e-06,  2.18863055e-06,
         2.05199319e-06,  2.16595138e-06,  2.07356047e-06,
         2.18601244e-06,  1.68565513e-06,  2.45571481e-06,
         2.09794860e-06,  2.25115985e-06,  2.17454436e-06,
         2.35615933e-06,  2.20528215e-06,  2.12274352e-06,
         2.04201442e-06,  2.09829840e-06,  2.37811914e-06,
         2.59584764e-06,  2.24411377e-06,  2.55720408e-06,
         2.15025863e-06,  2.15276858e-06,  2.18027521e-06,
...
         1.74692347e-06,  2.09443471e-06,  2.12973890e-06,
         2.34377034e-06,  2.17307013e-06,  2.06900046e-06,
         2.48694665e-06,  2.68753342e-06,  2.44880273e-06,
         2.47174120e-06,  2.42926438e-06,  2.17186103e-06,
         2.32406325e-06,  2.15099381e-06,  2.06423062e-06,
         2.04804246e-06,  2.13604914e-06,  2.40715923e-06,
         2.25096235e-06,  2.44024876e-06,  2.50823039e-06,
         2.74351940e-06,  2.92841144e-06,  2.93066534e-06,
         2.97954194e-06,  2.69012486e-06,  3.00694651e-06,
         3.22293420e-06,  3.30125998e-06,  2.88235454e-06,
         2.86702937e-06,  2.29472475e-06,  2.31164841e-06,
         1.95658398e-06,  1.98683092e-06,  2.02223960e-06,
         1.77555228e-06,  2.04982827e-06,  1.84649900e-06,
         1.62690884e-06,  1.96522386e-06,  2.35594340e-06,
         1.67864321e-06,  1.97675023e-06,  1.63441965e-06,
         1.84004448e-06,  2.02479524e-06,  1.99876820e-06,
         2.23792145e-06,  2.15529934e-06,  2.42778798e-06,
         2.00907165e-06,  2.02813404e-06,  1.82248581e-06,
                    nan,             nan,             nan,
                    nan,             nan,             nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xch4</span></div><div class='xr-var-dims'>(region, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-5b677f04-4304-4d62-a963-c7035fc42939' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5b677f04-4304-4d62-a963-c7035fc42939' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f81a471c-3ef3-4c1f-9125-aa130f9b5ade' class='xr-var-data-in' type='checkbox'><label for='data-f81a471c-3ef3-4c1f-9125-aa130f9b5ade' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[            nan,             nan,             nan,
                    nan,             nan,             nan,
         2.22663375e-09,  5.57128434e-09,  2.67606397e-09,
         6.94843542e-10, -1.42418242e-09,  1.71400707e-09,
        -3.47067084e-10, -1.90623344e-09, -2.39457902e-09,
        -3.72646954e-09, -1.87477279e-09,  1.58544428e-09,
        -2.77720576e-09, -3.19092582e-09, -2.86162854e-09,
        -2.95908093e-09,  3.40074963e-09,  2.61875933e-09,
        -7.30521742e-10, -7.13232604e-10, -1.16900934e-09,
        -1.07368759e-09, -1.20624259e-08, -1.70423731e-08,
        -4.56867957e-09, -5.89206334e-09, -5.48767835e-09,
        -5.48748446e-10,  8.23232843e-10, -1.10423004e-09,
         4.68502717e-09,  2.61289712e-09, -4.21716482e-09,
        -4.46957014e-09,  5.41884359e-09,  8.90873953e-09,
         9.55913696e-09,  7.24121647e-09,  1.24356393e-08,
         8.08737468e-09,  6.89705908e-10,  1.57879376e-09,
         2.69560485e-09,  4.04749389e-09,  7.50375080e-09,
         3.84910956e-09,  4.28004157e-09,  7.90318864e-09,
         1.02289412e-09,  1.38113918e-08,  6.70157518e-09,
         1.11806772e-08,  1.03204242e-08,  1.20993166e-08,
...
         6.42730201e-09,  8.98951581e-09,  9.17128371e-09,
         1.28159121e-08,  1.05098525e-08,  1.68580908e-08,
         1.02055342e-08,  7.78385660e-09,  9.07435586e-09,
         1.79471965e-08,  1.51272308e-08,  8.93689144e-09,
         1.06038766e-08,  8.28024926e-09,  8.80301274e-09,
         8.10456670e-09,  8.30945202e-09, -8.08630259e-09,
         2.03823489e-08,  2.02986909e-08,  1.71852723e-08,
         1.14655032e-08,  7.74279696e-09,  6.54313151e-09,
         8.90118219e-09,  6.77084351e-09,  5.60746370e-09,
         4.23927839e-09,  1.23325595e-08,  3.01178505e-08,
         5.06945584e-09,  4.73993330e-09, -9.33901196e-10,
         7.45633905e-09,  8.37337995e-09,  1.05569015e-08,
         5.58405795e-09,  1.20558504e-08,  1.49393431e-08,
         1.85695899e-08,  9.15718998e-09,  1.46908683e-08,
         1.55219464e-08,  1.24163074e-08,  1.94197195e-08,
         1.52906451e-08,  1.99332757e-08,  1.53082590e-08,
         2.12873702e-08,  1.72781290e-08,  1.68434528e-08,
         1.42427802e-08,  2.00536149e-08,  6.62397498e-09,
                    nan,             nan,             nan,
                    nan,             nan,             nan]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-17584013-93f2-4e2b-a7db-b648cda4e5b7' class='xr-section-summary-in' type='checkbox'  ><label for='section-17584013-93f2-4e2b-a7db-b648cda4e5b7' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-639acfe9-92ae-40d2-a6fb-d9d9111df844' class='xr-index-data-in' type='checkbox'/><label for='index-639acfe9-92ae-40d2-a6fb-d9d9111df844' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2003-01-01&#x27;, &#x27;2003-02-01&#x27;, &#x27;2003-03-01&#x27;, &#x27;2003-04-01&#x27;,
               &#x27;2003-05-01&#x27;, &#x27;2003-06-01&#x27;, &#x27;2003-07-01&#x27;, &#x27;2003-08-01&#x27;,
               &#x27;2003-09-01&#x27;, &#x27;2003-10-01&#x27;,
               ...
               &#x27;2021-03-01&#x27;, &#x27;2021-04-01&#x27;, &#x27;2021-05-01&#x27;, &#x27;2021-06-01&#x27;,
               &#x27;2021-07-01&#x27;, &#x27;2021-08-01&#x27;, &#x27;2021-09-01&#x27;, &#x27;2021-10-01&#x27;,
               &#x27;2021-11-01&#x27;, &#x27;2021-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=228, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>region</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1c0190cd-f7fa-4403-8fe2-e39c07e5bc74' class='xr-index-data-in' type='checkbox'/><label for='index-1c0190cd-f7fa-4403-8fe2-e39c07e5bc74' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;Global&#x27;, &#x27;Northern Hemishpere&#x27;, &#x27;Southern Hemisphere&#x27;], dtype=&#x27;object&#x27;, name=&#x27;region&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bdf16e60-36d7-41d0-96c8-b836e188bcd0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-bdf16e60-36d7-41d0-96c8-b836e188bcd0' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>The annual mean growth rates can be computed by averaging all the monthly sampled annual growth rates, which are located in the year of interest (e.g. 2003). For most years, 12 annual growth rate values are available for averaging but there are some exceptions. For example, for the year 2003 only six values are present and for the years 2014 and 2015 there are only 11 values, as no data are available for January 2015 due to issues with the GOSAT satellite.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># yearly sampled annual growth rates</span>
<span class="n">mean_growth_rates</span> <span class="o">=</span> <span class="n">growth_rates</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">mean_growth_rates</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="s1">&#39;ghg&#39;</span><span class="p">)</span> <span class="c1"># remember that we use &#39;dataset&#39; object instead of &#39;dataarray&#39; so that the information are visually nicer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (region: 3, year: 19)
Coordinates:
  * region   (region) &lt;U19 &#x27;Global&#x27; &#x27;Northern Hemishpere&#x27; &#x27;Southern Hemisphere&#x27;
  * year     (year) int64 2003 2004 2005 2006 2007 ... 2017 2018 2019 2020 2021
Data variables:
    xco2     (region, year) float64 1.311e-06 1.584e-06 ... 1.898e-06 2.113e-06
    xch4     (region, year) float64 1.91e-09 -1.203e-09 ... 1.441e-08 1.605e-08</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e6498d66-5f77-4895-95dd-3f67018b8c9f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e6498d66-5f77-4895-95dd-3f67018b8c9f' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>region</span>: 3</li><li><span class='xr-has-index'>year</span>: 19</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-2dfe4a61-eedf-46a8-964d-01c06d796228' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2dfe4a61-eedf-46a8-964d-01c06d796228' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>region</span></div><div class='xr-var-dims'>(region)</div><div class='xr-var-dtype'>&lt;U19</div><div class='xr-var-preview xr-preview'>&#x27;Global&#x27; ... &#x27;Southern Hemisphere&#x27;</div><input id='attrs-b25b3c16-70e5-4e5f-bc21-e7fc36ce8fbd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b25b3c16-70e5-4e5f-bc21-e7fc36ce8fbd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62da3140-ff53-4644-8f10-33f5e07b8f63' class='xr-var-data-in' type='checkbox'><label for='data-62da3140-ff53-4644-8f10-33f5e07b8f63' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Global&#x27;, &#x27;Northern Hemishpere&#x27;, &#x27;Southern Hemisphere&#x27;], dtype=&#x27;&lt;U19&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2003 2004 2005 ... 2019 2020 2021</div><input id='attrs-2e079e36-1113-4ed8-9528-22df82678d0e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2e079e36-1113-4ed8-9528-22df82678d0e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-51cc3d31-36a5-444d-bc18-b1e34b255f97' class='xr-var-data-in' type='checkbox'><label for='data-51cc3d31-36a5-444d-bc18-b1e34b255f97' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014,
       2015, 2016, 2017, 2018, 2019, 2020, 2021])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-94f8620c-783a-4ffc-867a-ef2badefefea' class='xr-section-summary-in' type='checkbox'  checked><label for='section-94f8620c-783a-4ffc-867a-ef2badefefea' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>xco2</span></div><div class='xr-var-dims'>(region, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.311e-06 1.584e-06 ... 2.113e-06</div><input id='attrs-f00d66ad-2ddb-4388-9839-5ac313b018aa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f00d66ad-2ddb-4388-9839-5ac313b018aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1277d44-4341-4794-a0e2-7008794c735a' class='xr-var-data-in' type='checkbox'><label for='data-d1277d44-4341-4794-a0e2-7008794c735a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.31131358e-06, 1.58417488e-06, 2.24087188e-06, 2.16699911e-06,
        2.25692374e-06, 1.67501424e-06, 1.88417964e-06, 2.41395775e-06,
        1.76239577e-06, 2.69202243e-06, 2.33468421e-06, 1.81065117e-06,
        2.83868990e-06, 2.86766607e-06, 2.12548262e-06, 2.38926944e-06,
        2.56071007e-06, 2.23789093e-06, 2.33213493e-06],
       [1.35666931e-06, 1.44566767e-06, 2.40335006e-06, 2.10683701e-06,
        2.36265255e-06, 1.65825566e-06, 1.83213489e-06, 2.56835835e-06,
        1.67698978e-06, 2.72959307e-06, 2.33508904e-06, 1.71053560e-06,
        2.84206728e-06, 3.07679900e-06, 1.99220948e-06, 2.40569566e-06,
        2.52219321e-06, 2.36876523e-06, 2.42432275e-06],
       [1.10374603e-06, 1.80183912e-06, 1.89099533e-06, 2.24383792e-06,
        2.12189156e-06, 1.67979538e-06, 1.80030246e-06, 1.99219625e-06,
        2.07731782e-06, 2.58462575e-06, 2.18085404e-06, 2.02600800e-06,
        2.93694227e-06, 2.38424836e-06, 2.27109062e-06, 2.41104802e-06,
        2.62685159e-06, 1.89778139e-06, 2.11345005e-06]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xch4</span></div><div class='xr-var-dims'>(region, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.91e-09 -1.203e-09 ... 1.605e-08</div><input id='attrs-2c99e0b4-385f-4643-96ec-afe10e98586a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2c99e0b4-385f-4643-96ec-afe10e98586a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12c12482-0850-4e11-83b6-df35b50857d7' class='xr-var-data-in' type='checkbox'><label for='data-12c12482-0850-4e11-83b6-df35b50857d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 1.90977504e-09, -1.20275081e-09, -4.13078477e-09,
         4.37755330e-09,  7.11795571e-09,  8.99232422e-09,
         7.15204800e-09,  6.28821763e-09,  5.47899102e-09,
         5.36077165e-09,  7.67494225e-09,  9.20594409e-09,
         8.37769252e-09,  7.71610897e-09,  8.27826894e-09,
         1.03601507e-08,  8.78043456e-09,  1.55122253e-08,
         1.81320847e-08],
       [ 1.27609772e-09, -2.28341830e-09, -2.54510269e-09,
         5.72371299e-09,  6.14129425e-09,  1.07292455e-08,
         4.08118392e-09,  5.35070552e-09,  6.11302186e-09,
         6.58402589e-09,  7.97683204e-09,  8.15783216e-09,
         8.51697795e-09,  8.87954207e-09,  7.40452971e-09,
         9.45090589e-09,  9.98346811e-09,  1.58400627e-08,
         1.78958448e-08],
       [ 3.52613350e-09,  1.15579419e-09, -9.52966086e-09,
         1.28608728e-09,  9.94927576e-09,  7.60946217e-09,
         1.12283637e-08,  7.54230982e-09,  3.51179037e-09,
         3.00824019e-09,  6.21213710e-09,  1.11899016e-08,
         9.43861901e-09,  4.22140586e-09,  1.11539185e-08,
         9.96938321e-09,  8.60260719e-09,  1.44072544e-08,
         1.60548870e-08]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f8e61204-f675-42a1-ad2d-914b3ab43b10' class='xr-section-summary-in' type='checkbox'  ><label for='section-f8e61204-f675-42a1-ad2d-914b3ab43b10' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>region</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-93ea0861-6446-4b65-b984-0e35adcb0b82' class='xr-index-data-in' type='checkbox'/><label for='index-93ea0861-6446-4b65-b984-0e35adcb0b82' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;Global&#x27;, &#x27;Northern Hemishpere&#x27;, &#x27;Southern Hemisphere&#x27;], dtype=&#x27;object&#x27;, name=&#x27;region&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2351504f-9b9e-4e03-bc8d-30a3e71c4f32' class='xr-index-data-in' type='checkbox'/><label for='index-2351504f-9b9e-4e03-bc8d-30a3e71c4f32' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014,
       2015, 2016, 2017, 2018, 2019, 2020, 2021],
      dtype=&#x27;int64&#x27;, name=&#x27;year&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9edf9da5-9b35-4bb8-8dfd-4ed4a212ce72' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9edf9da5-9b35-4bb8-8dfd-4ed4a212ce72' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="uncertainty-estimates-of-growth-rates">
<h3>Uncertainty estimates of growth rates<a class="headerlink" href="#uncertainty-estimates-of-growth-rates" title="Permalink to this heading">#</a></h3>
<p>We can compute a 1σ uncertainty estimate for each of the monthly sampled annual growth rates following Buchwitz et al. (2018). They have been computed such that they reflect the following aspects:</p>
<ol class="arabic simple">
<li><p>the <strong>standard error</strong> of the XCO2 concentration values for each of the grid cells (<code class="docutils literal notranslate"><span class="pre">term1</span></code>)</p></li>
<li><p>the <strong>spatial variability</strong> of the XCO2 within the selected region (<code class="docutils literal notranslate"><span class="pre">term2</span></code>)</p></li>
<li><p>the <strong>temporal variability</strong> of the annual growth rates in the 1-year time interval, which corresponds to the annual growth rate (<code class="docutils literal notranslate"><span class="pre">term3</span></code>), and</p></li>
<li><p>the number of months (<code class="docutils literal notranslate"><span class="pre">N</span></code>) with data located in that 1-year time interval.</p></li>
</ol>
<p>The 1σ uncertainties are then computed as
$<span class="math notranslate nohighlight">\(
\sigma = \frac{term1 + term2 + term3}{3\sqrt{N}}.
\)</span>$</p>
<div class="alert alert-block alert-success">
    <b>NOTE</b>: <br>
    As noted by Buchwitz et al. (2018) the aim is to provide realistic error estimates. However, they acknowledge that the uncertainty estimates are not based on full error propagation, which would be difficult, especially due to unknown or not well enough known systematic errors and error correlations. The reported uncertainty estimates should therefore be interpreted as error indications rather than fully rigorous error estimates.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_uncertainty</span><span class="p">(</span><span class="n">standard_error</span><span class="p">,</span> <span class="n">concentration</span><span class="p">,</span> <span class="n">growth_rates</span><span class="p">):</span>

    <span class="n">wghts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">concentration</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># weights for subselection</span>
    
    <span class="c1"># uncertainty estimation of growth rates</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="n">standard_error</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">wghts</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">))</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">wghts</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">))</span>
    <span class="n">term3</span> <span class="o">=</span> <span class="n">growth_rates</span><span class="o">.</span><span class="n">rolling</span><span class="p">({</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">growth_rates</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">rolling</span><span class="p">({</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="c1"># 1 sigma uncertainty</span>
    <span class="n">uncertainty</span> <span class="o">=</span> <span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span> <span class="o">+</span> <span class="n">term3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">uncertainty</span>


<span class="n">uncertainty</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">region</span><span class="p">,</span> <span class="n">coords</span> <span class="ow">in</span> <span class="n">region_of_interest</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">conc</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">coords</span><span class="p">)</span>
    <span class="n">se</span> <span class="o">=</span> <span class="n">std_error</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">coords</span><span class="p">)</span>
    <span class="n">gr</span> <span class="o">=</span> <span class="n">growth_rates</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">compute_uncertainty</span><span class="p">(</span><span class="n">se</span><span class="p">,</span> <span class="n">conc</span><span class="p">,</span> <span class="n">gr</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="n">region</span><span class="p">})</span>
    <span class="n">uncertainty</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>

<span class="n">uncertainty</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">uncertainty</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">)</span>  
<span class="n">uncertainty</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="s1">&#39;ghg&#39;</span><span class="p">)</span> <span class="c1"># remember that we use &#39;dataset&#39; object instead of &#39;dataarray&#39; so that the information are visually nicer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (region: 3, time: 228)
Coordinates:
  * time     (time) datetime64[ns] 2003-01-01 2003-02-01 ... 2021-12-01
  * region   (region) &lt;U19 &#x27;Global&#x27; &#x27;Northern Hemishpere&#x27; &#x27;Southern Hemisphere&#x27;
Data variables:
    xco2     (region, time) float64 nan nan 7.448e-07 ... 4.668e-07 nan
    xch4     (region, time) float64 nan nan 9.249e-09 ... 9.418e-09 nan</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5979c6ef-d9c5-4ff8-9b6c-89b6a34c6d2d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5979c6ef-d9c5-4ff8-9b6c-89b6a34c6d2d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>region</span>: 3</li><li><span class='xr-has-index'>time</span>: 228</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-8b3a2b44-fa34-4704-ac74-82ff7279ee68' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8b3a2b44-fa34-4704-ac74-82ff7279ee68' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2003-01-01 ... 2021-12-01</div><input id='attrs-26fcace2-a012-40b7-a34d-289451a2b5f1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-26fcace2-a012-40b7-a34d-289451a2b5f1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9e7197ab-93d0-4ec8-8cc8-c4b5aa55a438' class='xr-var-data-in' type='checkbox'><label for='data-9e7197ab-93d0-4ec8-8cc8-c4b5aa55a438' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2003-01-01T00:00:00.000000000&#x27;, &#x27;2003-02-01T00:00:00.000000000&#x27;,
       &#x27;2003-03-01T00:00:00.000000000&#x27;, ..., &#x27;2021-10-01T00:00:00.000000000&#x27;,
       &#x27;2021-11-01T00:00:00.000000000&#x27;, &#x27;2021-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>region</span></div><div class='xr-var-dims'>(region)</div><div class='xr-var-dtype'>&lt;U19</div><div class='xr-var-preview xr-preview'>&#x27;Global&#x27; ... &#x27;Southern Hemisphere&#x27;</div><input id='attrs-65d9fe64-0eae-4df8-9e54-eb3652a1e8d3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-65d9fe64-0eae-4df8-9e54-eb3652a1e8d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ea2bc890-923d-472b-8d0f-25e9e4124208' class='xr-var-data-in' type='checkbox'><label for='data-ea2bc890-923d-472b-8d0f-25e9e4124208' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Global&#x27;, &#x27;Northern Hemishpere&#x27;, &#x27;Southern Hemisphere&#x27;], dtype=&#x27;&lt;U19&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9e39a6b1-6db0-49e3-97f2-8fdd6757f1ff' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9e39a6b1-6db0-49e3-97f2-8fdd6757f1ff' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>xco2</span></div><div class='xr-var-dims'>(region, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan 7.448e-07 ... 4.668e-07 nan</div><input id='attrs-a63535ba-5af3-4642-9026-b31da2a7abd0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a63535ba-5af3-4642-9026-b31da2a7abd0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eef040ee-9dd5-489a-9f06-c598709104fa' class='xr-var-data-in' type='checkbox'><label for='data-eef040ee-9dd5-489a-9f06-c598709104fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan, 7.44806501e-07, 7.04525280e-07,
        5.50297241e-07, 4.29207781e-07, 5.23662507e-07, 4.74643338e-07,
        3.49155996e-07, 2.75224308e-07, 2.42830285e-07, 2.67017716e-07,
        2.66573172e-07, 2.83825497e-07, 3.26292266e-07, 3.45556181e-07,
        3.22175036e-07, 2.42178112e-07, 3.46998803e-07, 3.25672024e-07,
        2.67238402e-07, 2.29354600e-07, 2.17080366e-07, 2.23440039e-07,
        2.49475954e-07, 2.95668035e-07, 3.09124870e-07, 3.43174001e-07,
        3.02931229e-07, 2.49339699e-07, 3.21863937e-07, 3.10811270e-07,
        2.46210770e-07, 2.17354610e-07, 1.91329462e-07, 2.16760567e-07,
        2.50128038e-07, 3.33017626e-07, 3.29405209e-07, 3.65738201e-07,
        3.20276040e-07, 2.37186215e-07, 2.81836606e-07, 2.85332652e-07,
        2.22269305e-07, 1.95073521e-07, 1.73817354e-07, 2.15886206e-07,
        2.39222144e-07, 2.61562293e-07, 2.98217990e-07, 3.12384020e-07,
        2.74718745e-07, 2.20999670e-07, 2.80424469e-07, 2.93052630e-07,
        2.36837053e-07, 1.96004141e-07, 1.94876955e-07, 2.14729267e-07,
        2.53742589e-07, 3.02321828e-07, 3.62422328e-07, 3.79246279e-07,
        3.41066326e-07, 2.61371006e-07, 3.27689631e-07, 3.10147823e-07,
        2.60167466e-07, 1.98426200e-07, 1.90253671e-07, 2.10514981e-07,
        2.56365053e-07, 3.17939248e-07, 3.46970341e-07, 3.98019062e-07,
        3.53539204e-07, 3.10290866e-07, 3.60207088e-07, 3.96847017e-07,
...
        1.88627334e-07, 2.26784828e-07, 2.17457417e-07, 2.02184889e-07,
        2.21325189e-07, 2.30814564e-07, 2.26200313e-07, 2.32775866e-07,
        1.95111281e-07, 2.25710368e-07, 2.46830076e-07, 2.09714476e-07,
        2.21688821e-07, 2.41561293e-07, 2.17905994e-07, 2.38197179e-07,
        2.05602672e-07, 2.05903194e-07, 2.05629794e-07, 1.82507800e-07,
        2.14239136e-07, 2.26735421e-07, 2.51381341e-07, 1.89372883e-07,
        2.06710587e-07, 1.99079387e-07, 1.67710001e-07, 1.74135413e-07,
        1.97127360e-07, 1.99029622e-07, 1.93989585e-07, 1.70874595e-07,
        1.93696495e-07, 1.82118359e-07, 2.15386744e-07, 1.82601447e-07,
        1.57463606e-07, 1.88972228e-07, 1.60373306e-07, 2.07821309e-07,
        1.94573842e-07, 1.95189713e-07, 1.94283707e-07, 1.80997159e-07,
        2.23355893e-07, 2.45751553e-07, 2.45665794e-07, 2.12051768e-07,
        2.20676312e-07, 2.36937153e-07, 2.30604461e-07, 2.34457293e-07,
        2.24704105e-07, 2.55061904e-07, 2.41340444e-07, 2.36643592e-07,
        2.66378015e-07, 2.30877644e-07, 2.46987128e-07, 1.95322625e-07,
        1.81112234e-07, 1.99520394e-07, 2.04388903e-07, 2.06161513e-07,
        2.11326199e-07, 2.27878303e-07, 2.20260694e-07, 2.03520563e-07,
        2.02080206e-07, 2.41586419e-07, 2.66291104e-07, 2.58620332e-07,
        2.53942742e-07, 3.07993570e-07, 3.02744252e-07, 3.13784544e-07,
        4.27415003e-07, 4.56564634e-07, 4.66812702e-07,            nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xch4</span></div><div class='xr-var-dims'>(region, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan 9.249e-09 ... 9.418e-09 nan</div><input id='attrs-1df6cd6f-5627-46e8-9154-17d88131ed28' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1df6cd6f-5627-46e8-9154-17d88131ed28' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-964efce5-65ea-41dd-9396-c0186a05d4cf' class='xr-var-data-in' type='checkbox'><label for='data-964efce5-65ea-41dd-9396-c0186a05d4cf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan, 9.24927323e-09, 7.08325516e-09,
        6.00379238e-09, 5.36683729e-09, 5.22519743e-09, 5.65896227e-09,
        5.69664242e-09, 5.22539795e-09, 4.98573696e-09, 4.76614144e-09,
        4.39658083e-09, 4.25444728e-09, 3.95331606e-09, 3.47613437e-09,
        3.43028978e-09, 3.23031868e-09, 3.69008823e-09, 4.31494748e-09,
        4.47083377e-09, 4.17026929e-09, 4.36982887e-09, 4.64625762e-09,
        4.60982175e-09, 4.31649018e-09, 4.12300570e-09, 3.94114116e-09,
        3.87008567e-09, 3.87241168e-09, 4.13154286e-09, 4.96592402e-09,
        4.99917833e-09, 4.71060402e-09, 5.28315345e-09, 5.31425892e-09,
        4.78508154e-09, 4.60195455e-09, 4.53559203e-09, 4.21320983e-09,
        4.05554650e-09, 3.85219974e-09, 4.57709261e-09, 5.08491152e-09,
        5.10535310e-09, 5.14028860e-09, 5.02824543e-09, 5.01446903e-09,
        4.80164025e-09, 4.76178385e-09, 4.38926794e-09, 4.02698790e-09,
        3.96921058e-09, 3.88577679e-09, 4.17614398e-09, 4.76949896e-09,
        4.95216668e-09, 5.01072393e-09, 5.10980698e-09, 4.72756641e-09,
        4.53395609e-09, 4.75648549e-09, 4.29415953e-09, 4.29465963e-09,
        4.01231064e-09, 3.68419028e-09, 4.13929561e-09, 4.83896905e-09,
        4.93111039e-09, 5.07966796e-09, 5.11032578e-09, 5.38069410e-09,
        4.44614695e-09, 4.56429784e-09, 4.78946749e-09, 3.64451996e-09,
        3.39160430e-09, 3.22410737e-09, 3.15462080e-09, 3.37003919e-09,
...
        3.05665452e-09, 2.87278252e-09, 2.65354762e-09, 2.85165208e-09,
        3.14286395e-09, 2.80176502e-09, 3.32632006e-09, 3.77758387e-09,
        4.02519765e-09, 4.57352996e-09, 3.54197775e-09, 3.32128703e-09,
        2.90506140e-09, 2.86318213e-09, 2.70257048e-09, 2.75057629e-09,
        3.07758655e-09, 2.92001279e-09, 2.91870697e-09, 3.19650819e-09,
        3.68383999e-09, 4.20592407e-09, 3.97977363e-09, 3.47933437e-09,
        2.93924262e-09, 2.85874215e-09, 2.50259198e-09, 2.92227849e-09,
        3.08947683e-09, 2.97999467e-09, 2.95893988e-09, 3.70180112e-09,
        3.99137846e-09, 4.07862593e-09, 4.76040373e-09, 3.82644562e-09,
        3.57426136e-09, 3.33362356e-09, 2.74181207e-09, 3.22741841e-09,
        3.38693777e-09, 3.33533520e-09, 3.25992053e-09, 3.12725445e-09,
        4.48762221e-09, 4.62725663e-09, 4.46090563e-09, 4.35366020e-09,
        3.47502274e-09, 3.16242092e-09, 3.03310971e-09, 3.23981558e-09,
        3.19878107e-09, 3.14258877e-09, 3.79814775e-09, 4.71034525e-09,
        5.05587617e-09, 4.97615948e-09, 4.49871813e-09, 4.06627007e-09,
        3.54809986e-09, 3.21245774e-09, 2.95819812e-09, 2.99444665e-09,
        3.51247246e-09, 3.18557736e-09, 3.47293855e-09, 4.38652084e-09,
        4.74670218e-09, 4.71309495e-09, 4.94464548e-09, 4.59742068e-09,
        4.42190180e-09, 4.32322580e-09, 4.51235712e-09, 4.79216669e-09,
        5.78338631e-09, 7.37816502e-09, 9.41755430e-09,            nan]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8793eacb-a75b-4154-bbea-1d05d1f6ffab' class='xr-section-summary-in' type='checkbox'  ><label for='section-8793eacb-a75b-4154-bbea-1d05d1f6ffab' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7f07c62e-b0e4-4fce-97b1-ca81e87521df' class='xr-index-data-in' type='checkbox'/><label for='index-7f07c62e-b0e4-4fce-97b1-ca81e87521df' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2003-01-01&#x27;, &#x27;2003-02-01&#x27;, &#x27;2003-03-01&#x27;, &#x27;2003-04-01&#x27;,
               &#x27;2003-05-01&#x27;, &#x27;2003-06-01&#x27;, &#x27;2003-07-01&#x27;, &#x27;2003-08-01&#x27;,
               &#x27;2003-09-01&#x27;, &#x27;2003-10-01&#x27;,
               ...
               &#x27;2021-03-01&#x27;, &#x27;2021-04-01&#x27;, &#x27;2021-05-01&#x27;, &#x27;2021-06-01&#x27;,
               &#x27;2021-07-01&#x27;, &#x27;2021-08-01&#x27;, &#x27;2021-09-01&#x27;, &#x27;2021-10-01&#x27;,
               &#x27;2021-11-01&#x27;, &#x27;2021-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=228, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>region</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ec897f2d-0382-4ec5-a99a-147f0b0faf76' class='xr-index-data-in' type='checkbox'/><label for='index-ec897f2d-0382-4ec5-a99a-147f0b0faf76' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;Global&#x27;, &#x27;Northern Hemishpere&#x27;, &#x27;Southern Hemisphere&#x27;], dtype=&#x27;object&#x27;, name=&#x27;region&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-348c4378-71c6-40bf-a483-2af79472835c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-348c4378-71c6-40bf-a483-2af79472835c' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>The uncertainty of the annual mean growth rate has been computed by averaging the uncertainties assigned to each of the monthly sampled annual growth rates scaled with a factor, which depends on the number of months (<span class="math notranslate nohighlight">\(N'\)</span>=<code class="docutils literal notranslate"><span class="pre">number_months_available</span></code>) available for averaging. This factor is the square root of <span class="math notranslate nohighlight">\(12/N'\)</span>. It ensures that the larger the uncertainty, the fewer data points there are available for averaging.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">number_months_available</span> <span class="o">=</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">mean_uncertainty</span> <span class="o">=</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">12</span> <span class="o">/</span> <span class="n">number_months_available</span><span class="p">)</span>

<span class="p">(</span><span class="mf">1e6</span><span class="o">*</span><span class="n">mean_uncertainty</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="s1">&#39;xco2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># show the uncertainties of XCO2 in ppm</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (region: 3, year: 19)&gt;
array([[0.5 , 0.28, 0.27, 0.27, 0.25, 0.28, 0.31, 0.3 , 0.32, 0.31, 0.32,
        0.31, 0.33, 0.3 , 0.3 , 0.3 , 0.31, 0.31, 0.47],
       [0.45, 0.26, 0.24, 0.24, 0.23, 0.25, 0.28, 0.27, 0.28, 0.28, 0.28,
        0.28, 0.3 , 0.27, 0.26, 0.26, 0.27, 0.27, 0.42],
       [0.36, 0.2 , 0.19, 0.2 , 0.2 , 0.22, 0.21, 0.21, 0.2 , 0.2 , 0.2 ,
        0.2 , 0.22, 0.22, 0.2 , 0.19, 0.23, 0.22, 0.33]])
Coordinates:
    ghg      &lt;U4 &#x27;xco2&#x27;
  * region   (region) &lt;U19 &#x27;Global&#x27; &#x27;Northern Hemishpere&#x27; &#x27;Southern Hemisphere&#x27;
  * year     (year) int64 2003 2004 2005 2006 2007 ... 2017 2018 2019 2020 2021</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>region</span>: 3</li><li><span class='xr-has-index'>year</span>: 19</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-2241d9e2-5d7e-4876-86c3-e8fac3d3bb36' class='xr-array-in' type='checkbox' checked><label for='section-2241d9e2-5d7e-4876-86c3-e8fac3d3bb36' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.5 0.28 0.27 0.27 0.25 0.28 0.31 ... 0.22 0.2 0.19 0.23 0.22 0.33</span></div><div class='xr-array-data'><pre>array([[0.5 , 0.28, 0.27, 0.27, 0.25, 0.28, 0.31, 0.3 , 0.32, 0.31, 0.32,
        0.31, 0.33, 0.3 , 0.3 , 0.3 , 0.31, 0.31, 0.47],
       [0.45, 0.26, 0.24, 0.24, 0.23, 0.25, 0.28, 0.27, 0.28, 0.28, 0.28,
        0.28, 0.3 , 0.27, 0.26, 0.26, 0.27, 0.27, 0.42],
       [0.36, 0.2 , 0.19, 0.2 , 0.2 , 0.22, 0.21, 0.21, 0.2 , 0.2 , 0.2 ,
        0.2 , 0.22, 0.22, 0.2 , 0.19, 0.23, 0.22, 0.33]])</pre></div></div></li><li class='xr-section-item'><input id='section-546a89b8-79b7-44b3-bf52-94a609c569f4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-546a89b8-79b7-44b3-bf52-94a609c569f4' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ghg</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U4</div><div class='xr-var-preview xr-preview'>&#x27;xco2&#x27;</div><input id='attrs-864dee97-a412-44a9-a5ac-c4066c0cd482' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-864dee97-a412-44a9-a5ac-c4066c0cd482' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae3b4969-381e-4b7b-86b2-6061c2ed2a8f' class='xr-var-data-in' type='checkbox'><label for='data-ae3b4969-381e-4b7b-86b2-6061c2ed2a8f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;xco2&#x27;, dtype=&#x27;&lt;U4&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>region</span></div><div class='xr-var-dims'>(region)</div><div class='xr-var-dtype'>&lt;U19</div><div class='xr-var-preview xr-preview'>&#x27;Global&#x27; ... &#x27;Southern Hemisphere&#x27;</div><input id='attrs-45dae663-78cc-459e-a5f1-eb3128c4bcf4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-45dae663-78cc-459e-a5f1-eb3128c4bcf4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc601197-fe7d-4b5d-ad1e-f23d898a09d2' class='xr-var-data-in' type='checkbox'><label for='data-cc601197-fe7d-4b5d-ad1e-f23d898a09d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;Global&#x27;, &#x27;Northern Hemishpere&#x27;, &#x27;Southern Hemisphere&#x27;], dtype=&#x27;&lt;U19&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2003 2004 2005 ... 2019 2020 2021</div><input id='attrs-9f70bf19-70a5-45cf-9d98-03321a649e93' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9f70bf19-70a5-45cf-9d98-03321a649e93' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-430f33f1-42e6-4af4-8ebe-5a6ce1e80f76' class='xr-var-data-in' type='checkbox'><label for='data-430f33f1-42e6-4af4-8ebe-5a6ce1e80f76' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014,
       2015, 2016, 2017, 2018, 2019, 2020, 2021])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e703a0e5-c22a-40e1-bd8d-aee6ffef7b94' class='xr-section-summary-in' type='checkbox'  ><label for='section-e703a0e5-c22a-40e1-bd8d-aee6ffef7b94' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>region</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c38e0b34-6bbb-46fa-8695-929136367204' class='xr-index-data-in' type='checkbox'/><label for='index-c38e0b34-6bbb-46fa-8695-929136367204' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;Global&#x27;, &#x27;Northern Hemishpere&#x27;, &#x27;Southern Hemisphere&#x27;], dtype=&#x27;object&#x27;, name=&#x27;region&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f4258ded-9ed3-44e7-9fec-909326366bbc' class='xr-index-data-in' type='checkbox'/><label for='index-f4258ded-9ed3-44e7-9fec-909326366bbc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014,
       2015, 2016, 2017, 2018, 2019, 2020, 2021],
      dtype=&#x27;int64&#x27;, name=&#x27;year&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cdc8e570-329b-4b7c-919c-3e3efe62da2d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-cdc8e570-329b-4b7c-919c-3e3efe62da2d' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Overall, the uncertainty estimate is quite conservative, as it does not assume that errors improve upon averaging. As a result of this procedure, the error bar of the year 2003 growth rate is quite large. This is because the monthly sampled annual growth rate varies significantly in 2003 and because only <span class="math notranslate nohighlight">\(N=6\)</span> data points are available for averaging in 2003. In contrast, the year 2005 growth rate uncertainty is much smaller, because the growth rates vary less during 2005 and because <span class="math notranslate nohighlight">\(N=12\)</span> data points are available for averaging.</p>
</section>
<section id="plot-the-evolution-of-ghg-concentration-and-growth-rates">
<h3>Plot the evolution of GHG concentration and growth rates.<a class="headerlink" href="#plot-the-evolution-of-ghg-concentration-and-growth-rates" title="Permalink to this heading">#</a></h3>
<p>Generate auxiliary data used for plotting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prop_cycle_clrs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>

<span class="n">aux_var</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;xco2&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Atmospheric carbon dioxide&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;ppm&#39;</span><span class="p">,</span> <span class="s1">&#39;unit_factor&#39;</span><span class="p">:</span> <span class="mf">1e6</span><span class="p">,</span> <span class="c1"># unit factor cause data are not in the unit of interest</span>
        <span class="s1">&#39;shortname&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CO$_</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">prop_cycle_clrs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;ylim&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">370</span><span class="p">,</span> <span class="mi">420</span><span class="p">),</span> <span class="s1">&#39;ylim_growth&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="s1">&#39;xch4&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Atmospheric methane&#39;</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;ppb&#39;</span><span class="p">,</span> <span class="s1">&#39;unit_factor&#39;</span><span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
        <span class="s1">&#39;shortname&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;CH$_</span><span class="si">{4}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">prop_cycle_clrs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ylim&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1725</span><span class="p">,</span> <span class="mi">1950</span><span class="p">),</span> <span class="s1">&#39;ylim_growth&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Create plotting functions for the timeseries and the barplot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_summary_plot</span><span class="p">(</span><span class="n">ghg_conc</span><span class="p">,</span> <span class="n">growth_rates</span><span class="p">,</span> <span class="n">uncertainty</span><span class="p">,</span> <span class="n">aux_var</span><span class="p">):</span>
    
    <span class="s1">&#39;Create function for plotting timeseries (as lines)&#39;</span>
    
    <span class="n">ghg_conc</span> <span class="o">=</span> <span class="n">ghg_conc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">growth_rates</span> <span class="o">=</span> <span class="n">growth_rates</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">uncertainty</span> <span class="o">=</span> <span class="n">uncertainty</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># create the figure layout and the subplots</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">y_label0</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;A | Column-averaged </span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="s2">&quot;shortname&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">y_label1</span> <span class="o">=</span> <span class="s1">&#39;B | Annual growth rate&#39;</span>
    
    <span class="c1"># multiply with unit factor</span>
    <span class="n">ghg_conc</span> <span class="o">*=</span> <span class="n">aux_var</span><span class="p">[</span><span class="s1">&#39;unit_factor&#39;</span><span class="p">]</span>
    <span class="n">growth_rates</span> <span class="o">*=</span> <span class="n">aux_var</span><span class="p">[</span><span class="s1">&#39;unit_factor&#39;</span><span class="p">]</span>
    <span class="n">uncertainty</span> <span class="o">*=</span> <span class="n">aux_var</span><span class="p">[</span><span class="s1">&#39;unit_factor&#39;</span><span class="p">]</span>

    <span class="c1"># GHG concentrations</span>
    <span class="n">ghg_conc</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">add_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Raw data&#39;</span><span class="p">,</span> <span class="s1">&#39;Smoothed&#39;</span><span class="p">])</span>
    <span class="c1"># add legend in the center right of the plot</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="c1"># GHG growth rates</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">growth_rates</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">growth_rates</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">uncertainty</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="c1"># add a dashed line at zero</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

    <span class="c1"># format the axes</span>
    <span class="p">[</span><span class="n">i_ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i_ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>
    <span class="p">[</span><span class="n">i_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i_ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">]</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">y_label0</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">y_label1</span><span class="p">)</span>
    <span class="c1"># add unit as text below title in smaller font</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">.98</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39; in </span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">.98</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39; in </span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">/yr&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">)</span>

    <span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">ghg_conc</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>    
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">start_date</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">end_date</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>    

    <span class="c1"># get xticks as datetime objects every even year</span>
    <span class="n">xticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_date</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">end_date</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">tick</span><span class="o">.</span><span class="n">year</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">xticks</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">tick</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">xticks</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">tick</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">xticks</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># define the limits of the y axis</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">aux_var</span><span class="p">[</span><span class="s1">&#39;ylim&#39;</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">aux_var</span><span class="p">[</span><span class="s1">&#39;ylim_growth&#39;</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># trimming the y and x axis to be visible only from the fist till the last tick</span>

    <span class="c1"># add a small map showing the spatial domain that was used to derive the timeseries. This will be done with the help of inset_axes</span>
    <span class="n">axins</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;30%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;30%&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,</span> 
                    <span class="n">axes_class</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">geoaxes</span><span class="o">.</span><span class="n">GeoAxes</span><span class="p">,</span> 
                    <span class="n">axes_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">EqualEarth</span><span class="p">()))</span>
    <span class="n">axins</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.6&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>

    <span class="n">region</span> <span class="o">=</span> <span class="n">ghg_conc</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">region_of_interest</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">region_of_interest</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">start</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">region_of_interest</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">,</span> <span class="n">region_of_interest</span><span class="p">[</span><span class="n">region</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">y0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y0</span><span class="p">]</span>
    <span class="n">axins</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axins</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span> <span class="c1"># adjust the space between the subplots</span>


    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span>
</pre></div>
</div>
</div>
</div>
<p>Create the plot for CH4.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable</span> <span class="o">=</span> <span class="s1">&#39;xch4&#39;</span>
<span class="n">region</span> <span class="o">=</span> <span class="s1">&#39;Global&#39;</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_summary_plot</span><span class="p">(</span>
    <span class="n">spatial_aver</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">),</span>
    <span class="n">mean_growth_rates</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">),</span>
    <span class="n">mean_uncertainty</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">),</span>
    <span class="n">aux_var</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># add text highlighting the gap on the data</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
               <span class="s1">&#39;Gap on the measurements due to </span><span class="se">\n</span><span class="s1">issues with the GOSAT satellite.&#39;</span><span class="p">,</span>
               <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;20150110&#39;</span><span class="p">),</span> <span class="mi">1817</span><span class="p">),</span>
               <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
               <span class="n">textcoords</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
               <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s1">&#39;arc3,rad=-0.2&#39;</span><span class="p">)</span>
            <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4cab82bf6a5da26372214381d8465c8e43be43417c2d9a0116bf32838d97aefc.png" src="../_images/4cab82bf6a5da26372214381d8465c8e43be43417c2d9a0116bf32838d97aefc.png" />
</div>
</div>
<p>Create the plot for CO2.</p>
<p>One important climate milestone for our combat against climate change was the 400ppm for CO2 concentrations. A milestone that we unfortunatelly exceeded some years ago. Let’s find out when exactly did this happen for the first time, and add this information to the relevant plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the date the CO2 concentrations exceed a certain threshold for the first time</span>
<span class="n">thrs</span> <span class="o">=</span> <span class="mf">400e-6</span>  <span class="c1"># threshold for CO2 concentration (400 ppm)</span>

<span class="n">is_above_thrs</span> <span class="o">=</span> <span class="n">spatial_aver</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="s1">&#39;xco2&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="s1">&#39;Global&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">400e-6</span>
<span class="n">idx_first_time_step_above_thrs</span> <span class="o">=</span> <span class="n">is_above_thrs</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">first_time_thrs</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">idx_first_time_step_above_thrs</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">first_time_thrs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">first_time_thrs</span><span class="p">)</span>
<span class="n">first_time_thrs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2015-03-01 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable</span> <span class="o">=</span> <span class="s1">&#39;xco2&#39;</span>
<span class="n">region</span> <span class="o">=</span> <span class="s1">&#39;Global&#39;</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">create_summary_plot</span><span class="p">(</span>
    <span class="n">spatial_aver</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">),</span>
    <span class="n">mean_growth_rates</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">),</span>
    <span class="n">mean_uncertainty</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">),</span>
    <span class="n">aux_var</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># add text about the 400ppm in case of CO2 with an arrow pointing to the maximum value</span>
<span class="n">desc</span> <span class="o">=</span> <span class="s1">&#39;In &#39;</span> <span class="o">+</span> <span class="n">first_time_thrs</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%B %Y&#39;</span><span class="p">)</span> 
<span class="n">desc</span> <span class="o">+=</span> <span class="s1">&#39;, atmospheric CO$_2$ concentrations </span><span class="se">\n</span><span class="s1">surpassed 400 ppm, a milestone unseen in </span><span class="se">\n</span><span class="s1">over 800,000 years.&#39;</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
               <span class="n">desc</span><span class="p">,</span>
               <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">first_time_thrs</span><span class="p">,</span> <span class="n">thrs</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">),</span>
               <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
               <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
               <span class="n">textcoords</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
               <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s1">&#39;arc3,rad=-0.2&#39;</span><span class="p">)</span>
            <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/20ff118d89d45884d7d75e4e4fcfb4f83e0588e86e85be2c9667f718382fd570.png" src="../_images/20ff118d89d45884d7d75e4e4fcfb4f83e0588e86e85be2c9667f718382fd570.png" />
</div>
</div>
<p>The above plots show a clear increasing trend in the concentrations of the GHG over the entire record. Moreover, it can be noticed that there is an evident seasonality for both GHG.</p>
<p>The rate of increase is quite varying across the years. Note that for the first and last year the results are not that reliable because there are only 6 months used in the analysis.</p>
</section>
<section id="comparing-co2-with-ch4">
<h3>Comparing CO2 with CH4<a class="headerlink" href="#comparing-co2-with-ch4" title="Permalink to this heading">#</a></h3>
<p>So far we have seen that there is indeed an increasing trend for both variables, while both of them have differences in the seasonal cycle and the annual growth rate.</p>
<p>Let’s now compare the behaviour across both variables. Since the values are of substantially different magnitude, we first need to normalize the data for being able to plot them on same plot.</p>
<div class="alert alert-block alert-warning">
<b>NOTE</b><br>Here we will use a simple normalization based on global mean and standard deviation. For the ones interested further, there is a small appendix demonstrating why considering anomalies based on monthly climatology, a method commonly used for other environmental variables, is not the best option in our case.</a></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spatial_aver_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">spatial_aver</span><span class="o">-</span><span class="n">spatial_aver</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">))</span><span class="o">/</span><span class="n">spatial_aver</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">spatial_aver_norm</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s1">&#39;Global&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;ghg&#39;</span><span class="p">,</span> <span class="n">add_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                             <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="n">aux_var</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;shortname&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">spatial_aver_norm</span><span class="o">.</span><span class="n">ghg</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Standardized anomalies&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly anomalies of GHG&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># trimming the y and x axis to be visible only from the fist till the last tick</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span> <span class="c1"># formatting is needed cause the above line breaks the time fo</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f4c92ec9d96c847af1a320d3958799cb0caef3cbaaaa67cf075b813f395fd783.png" src="../_images/f4c92ec9d96c847af1a320d3958799cb0caef3cbaaaa67cf075b813f395fd783.png" />
</div>
</div>
<p>After the simple normalization it seems that the main differences between the two variables lie in the seasonal cycle, which is shifted.</p>
</section>
<section id="regional-spatial-averages">
<h3>Regional spatial averages<a class="headerlink" href="#regional-spatial-averages" title="Permalink to this heading">#</a></h3>
<p>The above analysis covers a large part of the globe, which does not give us the opportunity to access spatial differences. For this part of the GHG analysis, let’s visualize the hemispheric and understand how the concentrations evolve in the northern vs southern hemisphere.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="p">(</span><span class="mf">1e6</span><span class="o">*</span><span class="n">spatial_aver</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="s1">&#39;xco2&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="n">add_legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">spatial_aver</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="p">(</span><span class="mf">1e9</span><span class="o">*</span><span class="n">spatial_aver</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="s1">&#39;xch4&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="n">add_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;xco2&#39;</span><span class="p">,</span> <span class="s1">&#39;xch4&#39;</span><span class="p">]):</span>
    <span class="n">y_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;A | Column-averaged </span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="s2">&quot;shortname&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">.96</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39; in </span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="s2">&quot;units&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2002</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c75b46ee0b02e5231b0e5392186f892582ba978d28fc0386cb3b1785ef82b2d1.png" src="../_images/c75b46ee0b02e5231b0e5392186f892582ba978d28fc0386cb3b1785ef82b2d1.png" />
</div>
</div>
<p>The methane (CH4) has a clear differentiation in the concentrations between the two hemispheres. CO2 shows no seasonality for the southern hemisphere. Can it be because we only use land, and land mass in the southern hemisphere is substantially smaller compared to the northern?</p>
<p>For both variables the northern hemisphere has the most impact in defining the global mean. What could be possible reasons for that? The larger land mass of northern hemisphere? Or maybe the fact that most of the global population and industrial activities lie in that hemisphere?</p>
<p>The differences are already visible in the hemispheric averages. What about the actual grid cells? Let’s find out…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the weights for the temporal smoothing based on number of days per month</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">values</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span>
<span class="n">days_month</span> <span class="o">=</span> <span class="p">[</span><span class="n">calendar</span><span class="o">.</span><span class="n">monthrange</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span> <span class="n">mn</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">yr</span><span class="p">,</span> <span class="n">mn</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">months</span><span class="p">)]</span>
<span class="n">weights_temporal</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span><span class="o">+</span><span class="n">days_month</span> <span class="c1"># temporal weights as xarray object (helps for automatic arrangements later)</span>
<span class="c1"># weights should be changed to NaN for the cells that hava NaN in the measurement</span>
<span class="n">weights_temporal</span> <span class="o">=</span> <span class="n">weights_temporal</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">concentration</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># created temporally-smoothed timeseries. Note that center=False this time, so the value refers to the 6-month period ending at the date</span>
<span class="n">temp_smoothed</span> <span class="o">=</span> <span class="p">(</span><span class="n">concentration</span><span class="o">*</span><span class="n">weights_temporal</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">temp_smoothed</span> <span class="o">/=</span> <span class="n">weights_temporal</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Define the function for plotting the spatial data for selected variable and 4 dates, with the first 2 referring to a year in the early periods and the last 2 to a more recent year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">spatial_plot</span><span class="p">(</span><span class="n">selected_dates</span><span class="p">,</span> <span class="n">selected_variable</span><span class="o">=</span><span class="s1">&#39;xco2&#39;</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inputs:</span>
<span class="sd">    selected_dates: a list with 4 dates</span>
<span class="sd">    selected_variable: &quot;xco2&quot; (default) or &quot;xch4&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_used</span> <span class="o">=</span> <span class="n">temp_smoothed</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">selected_dates</span><span class="p">,</span> <span class="n">ghg</span><span class="o">=</span><span class="n">selected_variable</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data_used</span> <span class="o">*=</span> <span class="n">aux_var</span><span class="p">[</span><span class="n">selected_variable</span><span class="p">][</span><span class="s1">&#39;unit_factor&#39;</span><span class="p">]</span> <span class="c1"># multiply with unit factor for getting correct units</span>

    <span class="c1"># get min/max values for the colorbars for the early and late subsets</span>
    <span class="n">early_dates_data</span> <span class="o">=</span> <span class="n">data_used</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">selected_dates</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># get subset of early dates</span>
    <span class="n">min_early</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">early_dates_data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.01</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="c1"># find min based on 1st Percentile</span>
    <span class="n">max_early</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">early_dates_data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.99</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="c1"># find max based on 99th Percentile</span>
    
    <span class="n">late_dates_data</span> <span class="o">=</span> <span class="n">data_used</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">selected_dates</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
    <span class="n">min_late</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">late_dates_data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.005</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">max_late</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">late_dates_data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">.995</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    
    <span class="c1"># define the figure</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">i_ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span> <span class="c1"># loop through the 4 axes, plot the data, and add background info (Land, Coastline)</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">values_early</span> <span class="o">=</span> <span class="n">data_used</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">selected_dates</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="c1"># get the subset to be plotted </span>
            <span class="n">plot_early</span> <span class="o">=</span> <span class="n">values_early</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">i_ax</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">min_early</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">max_early</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span> <span class="c1"># plot</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">values_late</span> <span class="o">=</span> <span class="n">data_used</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">selected_dates</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">plot_late</span> <span class="o">=</span> <span class="n">values_late</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">i_ax</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">min_late</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">max_late</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

        <span class="n">i_ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">)</span> <span class="c1"># add land</span>
        <span class="n">i_ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span> <span class="c1"># add coastline</span>
        <span class="c1"># add title</span>
        <span class="n">start_month</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">selected_dates</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">months</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%B&quot;</span><span class="p">)</span> <span class="c1"># get start month</span>
        <span class="n">end_month</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">selected_dates</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">i_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">end_month</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">start_month</span><span class="si">}</span><span class="s1"> - %B %Y&#39;</span><span class="p">))</span> <span class="c1"># add the final title</span>

    <span class="c1"># colorbar of early dates</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># define where the new axes fo</span>
    <span class="n">cbar_ax_early</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">])</span> <span class="c1"># define where the new axis for the colorbar will be added and specify its dimensions</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">plot_early</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax_early</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span> <span class="c1"># add the colorbar</span>
    <span class="n">cbar_ax_early</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="n">selected_variable</span><span class="p">][</span><span class="s1">&#39;shortname&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">[</span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="n">selected_variable</span><span class="p">][</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># add title</span>

    <span class="c1"># colorbar of late dates</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cbar_ax_late</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">,</span> <span class="mf">0.34</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">plot_late</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax_late</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">cbar_ax_late</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="n">selected_variable</span><span class="p">][</span><span class="s1">&#39;shortname&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">[</span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="n">selected_variable</span><span class="p">][</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spatial_plot</span><span class="p">([</span><span class="s1">&#39;20030601&#39;</span><span class="p">,</span> <span class="s1">&#39;20031201&#39;</span><span class="p">,</span> <span class="s1">&#39;20210601&#39;</span><span class="p">,</span> <span class="s1">&#39;20211201&#39;</span><span class="p">],</span> <span class="s1">&#39;xco2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_34343/988431502.py:52: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</pre></div>
</div>
<img alt="../_images/40207ed5ed41c85d28dc2cd5c8d68c89dcc5b5a88c9d35ea2dc6f62ed79b6182.png" src="../_images/40207ed5ed41c85d28dc2cd5c8d68c89dcc5b5a88c9d35ea2dc6f62ed79b6182.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spatial_plot</span><span class="p">([</span><span class="s1">&#39;20030601&#39;</span><span class="p">,</span> <span class="s1">&#39;20031201&#39;</span><span class="p">,</span> <span class="s1">&#39;20210601&#39;</span><span class="p">,</span> <span class="s1">&#39;20211201&#39;</span><span class="p">],</span> <span class="s1">&#39;xch4&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_34343/988431502.py:52: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  fig.tight_layout()
</pre></div>
</div>
<img alt="../_images/fdf0939c08496e4c2db50ebec3c9bb187b61391c96f52bc4ac5943fcea156ea7.png" src="../_images/fdf0939c08496e4c2db50ebec3c9bb187b61391c96f52bc4ac5943fcea156ea7.png" />
</div>
</div>
<div class="alert alert-block alert-success">
<p><b>SUMMARY</b>:<br>
In this tutorial we analysed the concentrations of two Greenhouse Gases (GHG), in particular the carbon dioxide (CO2), and the methane (CH4). We used data for the years 2003-2021 based on satellite measurements.<br>
The data showed that both GHG have a systematicly increasing trend of similar slope. This trend is a very alarming feature and as a lot of research has shown, it is the main cause of the ongoing climate change. CO2 and CH4 have a seasonal cycle which is slightly shifted, while there are substantial differences in the concentrations between the two hemispheres, especially so for the CH4.<br>
Now that we have a better understanding about the GHG let’s follow our <a class="reference external" href="https://github.com/ECMWFCode4Earth/sketchbook-earth/blob/main/tutorials/02_temperature.ipynb">next tutorial</a>, to find out what is happening in Earth’s temperature.</p>
</div></section>
</section>
<section id="section-4-useful-links">
<h2>Section 4. Useful links<a class="headerlink" href="#section-4-useful-links" title="Permalink to this heading">#</a></h2>
<p>For the ones interested in finding out more about GHG, please find below some links for relevant articles and visualizations:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://climate.copernicus.eu/climate-indicators/greenhouse-gas-concentrations">Greenhouse gas concentrations Climate Indicators Report</a></p></li>
<li><p><a class="reference external" href="https://gml.noaa.gov/ccgg/">Global Monitorin Laboratory</a> from <a class="reference external" href="https://www.noaa.gov/">NOAA</a>, with a lot of information, relevant plots, and raw data that can be freely donwloaded.</p></li>
<li><p>Lashof, D., Ahuja, D. Relative contributions of greenhouse gas emissions to global warming. Nature 344, 529–531 (1990). <a class="reference external" href="https://doi.org/10.1038/344529a0">https://doi.org/10.1038/344529a0</a></p></li>
<li><p>Buchwitz, M., Reuter, M., Schneising, O., Noël, S., Gier, B., Bovensmann, H., Burrows, J. P., Boesch, H., Anand, J., Parker, R. J., Somkuti, P., Detmers, R. G., Hasekamp, O. P., Aben, I., Butz, A., Kuze, A., Suto, H., Yoshida, Y., Crisp, D., and O’Dell, C.: Computation and analysis of atmospheric carbon dioxide annual mean growth rates from satellite observations during 2003–2016, Atmos. Chem. Phys., 18, 17355–17370 (2018), <a class="reference external" href="https://doi.org/10.5194/acp-18-17355-2018">https://doi.org/10.5194/acp-18-17355-2018</a></p></li>
<li><p>Buchwitz, M., Dils, B., Boesch, H., Brunner, D., Butz, A., Crevoisier, C., Detmers, R., Frankenberg, C., Hasekamp, O., Hewson, W., Laeng, A., Noël, S., Notholt, J., Parker, R., Reuter, M., Schneising, O., Somkuti, P., Sundström, A.-M., and De Wachter, E.: ESA Climate Change Initiative (CCI) Product Validation and Intercomparison Report (PVIR) for the Essential Climate Variable (ECV) Greenhouse Gases (GHG) for data set Climate Research Data Package No. 4 (CRDP#4), Technical Report, version 5, available at: <a class="reference external" href="http://www.esa-ghg-cci.org/?q=webfm_send/352">http://www.esa-ghg-cci.org/?q=webfm_send/352</a>, 253 pp. (2017)</p></li>
</ol>
</section>
<section id="appendices">
<h2>Appendices<a class="headerlink" href="#appendices" title="Permalink to this heading">#</a></h2>
<p>As we stated previously, we only used global mean and standard deviation for comparing both variables, and we did not use monthly climatology. Let’s see how the monthly climatology looks like, and why using it is not the best approach.</p>
<section id="appendix-a-monthly-climatology-of-the-variables">
<h3>Appendix A: Monthly climatology of the variables<a class="headerlink" href="#appendix-a-monthly-climatology-of-the-variables" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># what is normally done assuming a &#39;stationary&#39; behaviour of the variable</span>
<span class="n">climatology_mean</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span> <span class="c1"># climatological mean for each month</span>
<span class="n">climatology_std</span> <span class="o">=</span> <span class="n">concentration</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span> <span class="c1"># climatological standard deviation for each month</span>
<span class="n">anomalies</span> <span class="o">=</span> <span class="p">(</span><span class="n">concentration</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">climatology_mean</span><span class="p">)</span> <span class="c1"># anomalies after removing mean</span>
<span class="n">anomalies</span> <span class="o">=</span> <span class="n">anomalies</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">/</span><span class="n">climatology_std</span> <span class="c1"># final anomalies after dividing with standard deviation</span>
<span class="n">anomalies</span> <span class="o">=</span> <span class="n">area_weighted_spatial_average</span><span class="p">(</span><span class="n">anomalies</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">)))</span> <span class="c1"># get global average</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">anomalies</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span><span class="n">aux_var</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;shortname&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">spatial_aver_norm</span><span class="o">.</span><span class="n">ghg</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">anomalies</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">anomalies</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">move_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Monthly anomalies of GHG&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Standardized anomalies&#39;</span><span class="p">)</span>

<span class="n">date_annotate</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;201312&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y%m&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="s1">&#39;Notice the big step that occurs </span><span class="se">\n</span><span class="s1">for CH$_4$ at the end of each year.</span><span class="se">\n</span><span class="s1">Why is this happening?&#39;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">date_annotate</span><span class="p">,</span> <span class="n">anomalies</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="s1">&#39;xch4&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">date_annotate</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span>
            <span class="n">textcoords</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.3&#39;</span><span class="p">,</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s1">&#39;arc3,rad=-0.2&#39;</span><span class="p">)</span>
           <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/abb07e174d295d8dfcfe0989fef8cd3a95c2d41021bab0dc91891dac4a348e00.png" src="../_images/abb07e174d295d8dfcfe0989fef8cd3a95c2d41021bab0dc91891dac4a348e00.png" />
</div>
</div>
<p>Plot the monthly climatology (global average ) to understand if the issue is related to that step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clim_spatial</span> <span class="o">=</span> <span class="n">climatology_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">climatology_mean</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clim_spatial</span><span class="o">.</span><span class="n">ghg</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">clim_spatial</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">clim_spatial</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="n">aux_var</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;unit_factor&#39;</span><span class="p">])</span> 
    
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">ABC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">) &#39;</span><span class="o">+</span> <span class="n">aux_var</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">aux_var</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;shortname&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Colunn-averaged &#39;</span><span class="o">+</span> <span class="n">aux_var</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;shortname&#39;</span><span class="p">]</span>  <span class="o">+</span> <span class="s1">&#39; [&#39;</span> <span class="o">+</span> <span class="n">aux_var</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">trim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># trimming the y and x axis to be visible only from the fist till the last tick</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9053b1d1a44ef9ae2544f145b9003b58bb05c87effe412cc1494c670055e88bf.png" src="../_images/9053b1d1a44ef9ae2544f145b9003b58bb05c87effe412cc1494c670055e88bf.png" />
</div>
</div>
<p>Maybe its more useful to present the results in polar coordinates, since from a climatological point of view the months follow a circular behaviour with December being similar to January.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;polar&#39;</span><span class="p">})</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clim_spatial</span><span class="o">.</span><span class="n">ghg</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

    <span class="n">yy_values</span> <span class="o">=</span> <span class="n">clim_spatial</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="n">aux_var</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;unit_factor&#39;</span><span class="p">]</span> <span class="c1"># get the values and multiply with the unit factor</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="p">(</span><span class="n">clim_spatial</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">yy_values</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span> <span class="p">)</span> <span class="c1"># plot the line</span>
    
    <span class="c1"># color the graph based on y value for easily differentiating between the magnitudes for the months</span>
    <span class="n">segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yy_values</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yy_values</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1.</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">seg_min</span><span class="p">,</span> <span class="n">seg_max</span><span class="p">,</span> <span class="n">i_alpha</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">segments</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">segments</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">,</span> <span class="mf">.25</span><span class="p">)):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">360</span><span class="p">),</span> <span class="n">y1</span><span class="o">=</span><span class="n">seg_max</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="n">seg_min</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">i_alpha</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yy_values</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yy_values</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1.</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">((</span><span class="n">clim_spatial</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">segments</span><span class="p">[::</span><span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[::</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># otherwise the green line hiddes the yticks (red values) </span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">ABC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">) &#39;</span><span class="o">+</span> <span class="n">aux_var</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">aux_var</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;shortname&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_coords</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Colunn-averaged &#39;</span><span class="o">+</span> <span class="n">aux_var</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;shortname&#39;</span><span class="p">]</span>  <span class="o">+</span> <span class="s1">&#39; [&#39;</span> <span class="o">+</span> <span class="n">aux_var</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ecb14b64b21490c6b12502eabd397856375166dc05a5ee8310ff14d30a15f4b5.png" src="../_images/ecb14b64b21490c6b12502eabd397856375166dc05a5ee8310ff14d30a15f4b5.png" />
</div>
</div>
<p>Notice the difference in the values between January mean state and December mean state for both GHG, especially so for CH4. This indicates that on average just in the course of 1 single year there is already a substantial increase in the concentrations, that do alter the expected seasonal cycle, as we normally would see the Jan and Dec values being very very close.</p>
<p>Because of this substantial reduction in the mean state of January compared to Decembers we see the high jump for every January, as the climatological mean is small, thus the anomalies get large.</p>
<p>Therefore, in order to get the anomalies in a robust way, we should not only remove the seasonal cycle, but also detrend the data, as <strong>this dataset is highly non-stationary</strong>!</p>
</section>
<section id="appendix-b-using-reanalysis-data-available-at-the-atmopshere-data-store-ads">
<h3>Appendix B: Using reanalysis data available at the Atmopshere Data Store (ADS)<a class="headerlink" href="#appendix-b-using-reanalysis-data-available-at-the-atmopshere-data-store-ads" title="Permalink to this heading">#</a></h3>
<p>Besides satellite measurements for the GHG there are also global reanalysis products providing information about CO2 and CH4. Let’s use the one available in the Atmosphere Data Store (ADS).</br>
As we did with the CDS API, the same is also needed for the ADS, with a new registration to be completed at <a class="reference external" href="https://ads.atmosphere.copernicus.eu/api-how-to">https://ads.atmosphere.copernicus.eu/api-how-to</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ADS key</span>
<span class="n">ads_url</span> <span class="o">=</span> <span class="s1">&#39;https://ads.atmosphere.copernicus.eu/api/v2&#39;</span>
<span class="n">ads_key</span> <span class="o">=</span> <span class="s1">&#39;YOUR KEY&#39;</span> <span class="c1"># please add your key here the format should be as {uid}:{api-key}</span>
</pre></div>
</div>
</div>
</div>
<p>Get GHG data from reanalysis <a class="reference external" href="https://ads.atmosphere.copernicus.eu/cdsapp#!/dataset/cams-global-ghg-reanalysis-egg4-monthly?tab=overview">(EGG4) from ADS</a>. We use the monthly mean data for speeding the process. For the ones interested there is also a <a class="reference external" href="https://ads.atmosphere.copernicus.eu/cdsapp#!/dataset/cams-global-ghg-reanalysis-egg4?tab=overview">daily dataset</a> available.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get monthly mean grennhouse gases data from Atmosphere Data Store (it takes around 2 minutes)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">ads_url</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">ads_key</span><span class="p">)</span>

<span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="s1">&#39;cams-global-ghg-reanalysis-egg4-monthly&#39;</span><span class="p">,</span>
    <span class="p">{</span>
     <span class="s1">&#39;product_type&#39;</span><span class="p">:</span> <span class="s1">&#39;monthly_mean&#39;</span><span class="p">,</span>
     <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ch4_column_mean_molar_fraction&#39;</span><span class="p">,</span> <span class="s1">&#39;co2_column_mean_molar_fraction&#39;</span><span class="p">],</span> <span class="c1"># get the available variables</span>
     <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2021</span><span class="p">)),</span> <span class="c1"># get all available years (2003, 2004, ..., 2020)</span>
     <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)),</span> <span class="c1"># get all months Jan (1) up to Dec (12)</span>
     <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;netcdf&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}</span><span class="s1">greenhouse_gases.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-06-24 20:39:06,444 INFO Welcome to the CDS
2023-06-24 20:39:06,445 INFO Sending request to https://ads.atmosphere.copernicus.eu/api/v2/resources/cams-global-ghg-reanalysis-egg4-monthly
2023-06-24 20:39:06,610 INFO Request is completed
2023-06-24 20:39:06,611 INFO Downloading https://download-0003-ads-clone.copernicus-climate.eu/cache-compute-0003/cache/data1/adaptor.mars.external-1683983665.986999-18127-5-994cf598-7b63-4f76-915e-6310a89f2575.nc to data/greenhouse_gases.nc (95.3M)
2023-06-24 20:40:08,565 INFO Download rate 1.5M/s   
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result(content_length=99952612,content_type=application/x-netcdf,location=https://download-0003-ads-clone.copernicus-climate.eu/cache-compute-0003/cache/data1/adaptor.mars.external-1683983665.986999-18127-5-994cf598-7b63-4f76-915e-6310a89f2575.nc)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># open the GHG data and inspect the Dataset</span>
<span class="c1"># when the data are opened as below using &quot;with&quot; then the link to the actual dataset is closed, meaning that any other program can also access the file in the directory</span>
<span class="c1"># this is not the case for the normal opening of the file, as for the co2_satellites in the main section of this tutorial.</span>
<span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}</span><span class="s1">greenhouse_gases.nc&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ghg_reanalysis</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="n">ghg_reanalysis</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (longitude: 480, latitude: 241, time: 216)
Coordinates:
  * longitude  (longitude) float32 0.0 0.75 1.5 2.25 ... 357.0 357.8 358.5 359.2
  * latitude   (latitude) float32 90.0 89.25 88.5 87.75 ... -88.5 -89.25 -90.0
  * time       (time) datetime64[ns] 2003-01-01 2003-02-01 ... 2020-12-01
Data variables:
    tcch4      (time, latitude, longitude) float32 ...
    tcco2      (time, latitude, longitude) float32 ...
Attributes:
    Conventions:  CF-1.6
    history:      2023-05-13 13:14:27 GMT by grib_to_netcdf-2.25.1: /opt/ecmw...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-538b3afc-8197-47ea-bb3e-d04028824e8e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-538b3afc-8197-47ea-bb3e-d04028824e8e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>longitude</span>: 480</li><li><span class='xr-has-index'>latitude</span>: 241</li><li><span class='xr-has-index'>time</span>: 216</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f3789a57-755d-41da-b44e-915688bb646e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f3789a57-755d-41da-b44e-915688bb646e' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.75 1.5 ... 357.8 358.5 359.2</div><input id='attrs-02969e2a-b909-4aef-b3fe-11d1df3f38f1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-02969e2a-b909-4aef-b3fe-11d1df3f38f1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b45cf42a-1444-403e-a256-052481eb6986' class='xr-var-data-in' type='checkbox'><label for='data-b45cf42a-1444-403e-a256-052481eb6986' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>long_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([  0.  ,   0.75,   1.5 , ..., 357.75, 358.5 , 359.25], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>90.0 89.25 88.5 ... -89.25 -90.0</div><input id='attrs-135d745a-7a2c-4562-a1d6-c348b5c52e05' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-135d745a-7a2c-4562-a1d6-c348b5c52e05' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-965b8255-cd32-4758-a8ef-acc38c130684' class='xr-var-data-in' type='checkbox'><label for='data-965b8255-cd32-4758-a8ef-acc38c130684' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>long_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([ 90.  ,  89.25,  88.5 , ..., -88.5 , -89.25, -90.  ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2003-01-01 ... 2020-12-01</div><input id='attrs-ed4dc6b7-f75f-4486-a6e6-eb2c29e112ac' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ed4dc6b7-f75f-4486-a6e6-eb2c29e112ac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c82da6af-65bb-4159-8e0e-22ac49bd3a56' class='xr-var-data-in' type='checkbox'><label for='data-c82da6af-65bb-4159-8e0e-22ac49bd3a56' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2003-01-01T00:00:00.000000000&#x27;, &#x27;2003-02-01T00:00:00.000000000&#x27;,
       &#x27;2003-03-01T00:00:00.000000000&#x27;, ..., &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d1b8c08a-2ba0-4d90-83f2-bd6111b2ed6b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d1b8c08a-2ba0-4d90-83f2-bd6111b2ed6b' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tcch4</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-5a32b445-3dc1-4262-ba92-b83452348614' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5a32b445-3dc1-4262-ba92-b83452348614' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40b7a533-b830-4777-921e-c5814c7d9af0' class='xr-var-data-in' type='checkbox'><label for='data-40b7a533-b830-4777-921e-c5814c7d9af0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>ppb</dd><dt><span>long_name :</span></dt><dd>CH4 column-mean molar fraction</dd></dl></div><div class='xr-var-data'><pre>[24986880 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tcco2</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ddd6a676-07fc-48af-bc33-88bb5906121a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ddd6a676-07fc-48af-bc33-88bb5906121a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20218800-99bf-42dd-96df-2b6887e883f9' class='xr-var-data-in' type='checkbox'><label for='data-20218800-99bf-42dd-96df-2b6887e883f9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>ppm</dd><dt><span>long_name :</span></dt><dd>CO2 column-mean molar fraction</dd></dl></div><div class='xr-var-data'><pre>[24986880 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-30426268-7609-4339-aff2-415ba780da4f' class='xr-section-summary-in' type='checkbox'  ><label for='section-30426268-7609-4339-aff2-415ba780da4f' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>longitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-86afc4da-b60f-4af1-8346-d3f4c3749299' class='xr-index-data-in' type='checkbox'/><label for='index-86afc4da-b60f-4af1-8346-d3f4c3749299' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0.0,   0.75,    1.5,   2.25,    3.0,   3.75,    4.5,   5.25,    6.0,
         6.75,
       ...
        352.5, 353.25,  354.0, 354.75,  355.5, 356.25,  357.0, 357.75,  358.5,
       359.25],
      dtype=&#x27;float32&#x27;, name=&#x27;longitude&#x27;, length=480))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>latitude</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d0ef830f-29fe-4cb8-afa1-6480eef0d07a' class='xr-index-data-in' type='checkbox'/><label for='index-d0ef830f-29fe-4cb8-afa1-6480eef0d07a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  90.0,  89.25,   88.5,  87.75,   87.0,  86.25,   85.5,  84.75,   84.0,
        83.25,
       ...
       -83.25,  -84.0, -84.75,  -85.5, -86.25,  -87.0, -87.75,  -88.5, -89.25,
        -90.0],
      dtype=&#x27;float32&#x27;, name=&#x27;latitude&#x27;, length=241))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3954b084-12b9-4da0-b742-bfe4ff684338' class='xr-index-data-in' type='checkbox'/><label for='index-3954b084-12b9-4da0-b742-bfe4ff684338' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2003-01-01&#x27;, &#x27;2003-02-01&#x27;, &#x27;2003-03-01&#x27;, &#x27;2003-04-01&#x27;,
               &#x27;2003-05-01&#x27;, &#x27;2003-06-01&#x27;, &#x27;2003-07-01&#x27;, &#x27;2003-08-01&#x27;,
               &#x27;2003-09-01&#x27;, &#x27;2003-10-01&#x27;,
               ...
               &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;, &#x27;2020-05-01&#x27;, &#x27;2020-06-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2020-08-01&#x27;, &#x27;2020-09-01&#x27;, &#x27;2020-10-01&#x27;,
               &#x27;2020-11-01&#x27;, &#x27;2020-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=216, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e48de4ea-a58d-4452-a975-ab4d6f22ac4e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e48de4ea-a58d-4452-a975-ab4d6f22ac4e' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>2023-05-13 13:14:27 GMT by grib_to_netcdf-2.25.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf.bin -S param -o /cache/data1/adaptor.mars.external-1683983665.986999-18127-5-994cf598-7b63-4f76-915e-6310a89f2575.nc /cache/tmp/994cf598-7b63-4f76-915e-6310a89f2575-adaptor.mars.external-1683983601.5658066-18127-7-tmp.grib</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &quot;quick and dirty&quot; plot of the data</span>
<span class="n">ghg_reanalysis</span><span class="p">[</span><span class="s1">&#39;tcco2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7feb593c4dc0&gt;
</pre></div>
</div>
<img alt="../_images/341d49e5fd1a3446ac7fc9d2934cbf4c4fa85bad9321cc6fde7b70204c9f1a1b.png" src="../_images/341d49e5fd1a3446ac7fc9d2934cbf4c4fa85bad9321cc6fde7b70204c9f1a1b.png" />
</div>
</div>
<p>As we can notice, the dataset is a 3-dimensional cube (latitude, longitude, time) with information for two variables (C02, CH4). Also the spatial grid is 0.75 degrees and the data are also over the oceans. We see that this dataset has therefore some differences with the data from the satellites. This will make the task slightly more challenging, but its always nice to be able to see the results with more than 1 datasets… :)</p>
<p>Last data we need is the land-sea mask from ERA5 data. This is needed because the GHG measurements from the satellites are not available over the oceans. So we want to use also a mask for when using GHG data from the reanalysis dataset available from ADS. Note that the resolution (grid) should be specified, because the original one (0.25) is different that the resolution of GHG (0.75).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">cds_url</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">cds_key</span><span class="p">)</span>

<span class="c1"># we just need one random slice of land-sea mask (data are same for all time steps)</span>
<span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="s1">&#39;reanalysis-era5-single-levels&#39;</span><span class="p">,</span>
    <span class="p">{</span>
     <span class="s1">&#39;product_type&#39;</span><span class="p">:</span> <span class="s1">&#39;reanalysis&#39;</span><span class="p">,</span>
     <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;land_sea_mask&#39;</span><span class="p">,</span>
     <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="s1">&#39;2009&#39;</span><span class="p">,</span>
     <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span>
     <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="s1">&#39;16&#39;</span><span class="p">,</span>
     <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;00:00&#39;</span><span class="p">,</span>
     <span class="s1">&#39;grid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span> <span class="c1"># grid is specified because the default resolution is different</span>
     <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;netcdf&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}</span><span class="s1">land_sea_mask.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-06-24 20:40:18,450 INFO Welcome to the CDS
2023-06-24 20:40:18,452 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-06-24 20:40:18,725 INFO Request is completed
2023-06-24 20:40:18,726 INFO Downloading https://download-0003-clone.copernicus-climate.eu/cache-compute-0003/cache/data1/adaptor.mars.internal-1687620183.6590607-10262-1-9e941b38-8e5f-414c-a593-7937a273fd1e.nc to data/land_sea_mask.nc (229.8K)
2023-06-24 20:40:20,347 INFO Download rate 141.9K/s
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Result(content_length=235364,content_type=application/x-netcdf,location=https://download-0003-clone.copernicus-climate.eu/cache-compute-0003/cache/data1/adaptor.mars.internal-1687620183.6590607-10262-1-9e941b38-8e5f-414c-a593-7937a273fd1e.nc)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read the land-sea mask and visualize (&quot;quick and dirty&quot;) the data</span>
<span class="n">data_mask</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataarray</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dir_loc</span><span class="si">}</span><span class="s1">land_sea_mask.nc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">is_land</span> <span class="o">=</span> <span class="n">data_mask</span> <span class="o">&gt;=</span> <span class="mf">0.5</span> <span class="c1"># make data boolean (1-land, 0-sea), by converting all cells with at least 50% land, as only land</span>
<span class="n">is_land</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7feb59067a30&gt;
</pre></div>
</div>
<img alt="../_images/c42d628f87b6b9c4f29729e9d4aae5190c7ff338829f3bc1d09ed24d3eedd359.png" src="../_images/c42d628f87b6b9c4f29729e9d4aae5190c7ff338829f3bc1d09ed24d3eedd359.png" />
</div>
</div>
<p>For start, let’s apply the land mask on the reanalysis data, so that they are comperable with the satellite ones. Also, let’s name the coordinates and keys with the same name as with satellite data, and also have the same order (asceding) for the latitudes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ghg_reanalysis_land</span> <span class="o">=</span> <span class="n">ghg_reanalysis</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_land</span><span class="p">)</span> <span class="c1"># keep only land data</span>
<span class="n">ghg_reanalysis_land</span> <span class="o">=</span> <span class="n">ghg_reanalysis_land</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span> <span class="c1"># sort ascending</span>
<span class="n">ghg_reanalysis_land</span> <span class="o">=</span> <span class="n">ghg_reanalysis_land</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="s1">&#39;lon&#39;</span><span class="p">})</span> <span class="c1"># rename same as satellite coordinates</span>
<span class="n">ghg_reanalysis_land</span> <span class="o">=</span> <span class="n">ghg_reanalysis_land</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;tcch4&#39;</span><span class="p">:</span> <span class="s1">&#39;xch4&#39;</span><span class="p">,</span> <span class="s1">&#39;tcco2&#39;</span><span class="p">:</span> <span class="s1">&#39;xco2&#39;</span><span class="p">})</span> <span class="c1"># rename same as satellite names</span>
<span class="n">ghg_reanalysis_land</span> <span class="o">=</span> <span class="n">ghg_reanalysis_land</span><span class="o">.</span><span class="n">to_array</span><span class="p">(</span><span class="s1">&#39;ghg&#39;</span><span class="p">)</span>
<span class="n">ghg_reanalysis_land</span> <span class="o">=</span> <span class="n">area_weighted_spatial_average</span><span class="p">(</span><span class="n">ghg_reanalysis_land</span><span class="p">)</span>

<span class="n">ghg_satellites_land</span> <span class="o">=</span> <span class="n">area_weighted_spatial_average</span><span class="p">(</span><span class="n">concentration</span><span class="p">)</span>
<span class="n">unit_factor_xr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">([</span><span class="n">aux_var</span><span class="p">[</span><span class="n">i_ghg</span><span class="p">][</span><span class="s1">&#39;unit_factor&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i_ghg</span> <span class="ow">in</span> <span class="n">aux_var</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ghg&#39;</span><span class="p">:</span> <span class="n">aux_var</span><span class="o">.</span><span class="n">keys</span><span class="p">()})</span> <span class="c1"># auxiliary variable</span>
<span class="n">ghg_satellites_land</span> <span class="o">*=</span> <span class="n">unit_factor_xr</span> <span class="c1"># multiply with the unit factor for having the correct units</span>
</pre></div>
</div>
</div>
</div>
<p>Create the final array with combining the data from both products and deriving the global average.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ghg_both_datasets</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ghg_satellites_land</span><span class="p">,</span> <span class="n">ghg_reanalysis_land</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;satellites&#39;</span><span class="p">,</span> <span class="s1">&#39;reanalysis&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">))</span>
<span class="n">ghg_both_datasets</span><span class="o">.</span><span class="n">to_dataset</span><span class="p">(</span><span class="s1">&#39;ghg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (product: 2, time: 228)
Coordinates:
  * time     (time) datetime64[ns] 2003-01-01 2003-02-01 ... 2021-12-01
  * product  (product) object &#x27;satellites&#x27; &#x27;reanalysis&#x27;
Data variables:
    xch4     (product, time) float64 1.741e+03 1.739e+03 1.743e+03 ... nan nan
    xco2     (product, time) float64 375.8 376.5 376.4 376.2 ... nan nan nan nan</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-72951add-1aae-4de5-b286-43c80e924800' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-72951add-1aae-4de5-b286-43c80e924800' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>product</span>: 2</li><li><span class='xr-has-index'>time</span>: 228</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-aff9ff4f-42c4-4f0d-9eb8-0cbfc04d0186' class='xr-section-summary-in' type='checkbox'  checked><label for='section-aff9ff4f-42c4-4f0d-9eb8-0cbfc04d0186' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2003-01-01 ... 2021-12-01</div><input id='attrs-a9dac4cf-9733-44b4-8a2d-1083ed8252d4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a9dac4cf-9733-44b4-8a2d-1083ed8252d4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27306d3c-976a-444a-a35d-c16bf4e3ae0c' class='xr-var-data-in' type='checkbox'><label for='data-27306d3c-976a-444a-a35d-c16bf4e3ae0c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2003-01-01T00:00:00.000000000&#x27;, &#x27;2003-02-01T00:00:00.000000000&#x27;,
       &#x27;2003-03-01T00:00:00.000000000&#x27;, ..., &#x27;2021-10-01T00:00:00.000000000&#x27;,
       &#x27;2021-11-01T00:00:00.000000000&#x27;, &#x27;2021-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>product</span></div><div class='xr-var-dims'>(product)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;satellites&#x27; &#x27;reanalysis&#x27;</div><input id='attrs-f0ee7384-ffa9-4296-9009-ef8f6205d623' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f0ee7384-ffa9-4296-9009-ef8f6205d623' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7137d299-508d-448d-b7f6-c61c7bc1fe95' class='xr-var-data-in' type='checkbox'><label for='data-7137d299-508d-448d-b7f6-c61c7bc1fe95' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;satellites&#x27;, &#x27;reanalysis&#x27;], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9c645e23-0f57-4adc-a25c-1d8609e73e07' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9c645e23-0f57-4adc-a25c-1d8609e73e07' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>xch4</span></div><div class='xr-var-dims'>(product, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.741e+03 1.739e+03 ... nan nan</div><input id='attrs-62f96e09-5416-4de9-8a33-0c34f30f0b66' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-62f96e09-5416-4de9-8a33-0c34f30f0b66' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6e9a5d02-fc8d-4af0-bc5c-4990969dc795' class='xr-var-data-in' type='checkbox'><label for='data-6e9a5d02-fc8d-4af0-bc5c-4990969dc795' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1741.23127508, 1739.12834582, 1743.13047225, 1745.47630481,
        1747.8758751 , 1748.00985537, 1753.12395335, 1760.35192316,
        1764.95140171, 1766.69461906, 1760.34334849, 1752.17242984,
        1743.97757365, 1743.77518809, 1745.78150051, 1746.79868416,
        1745.88501595, 1749.21916938, 1752.09296218, 1757.6006802 ,
        1762.10983961, 1762.79164166, 1759.325394  , 1752.47136213,
        1742.69425361, 1743.47769664, 1742.79539691, 1743.38752433,
        1749.20885171, 1751.66695391, 1751.34765373, 1756.7452907 ,
        1760.67348472, 1761.98339554, 1751.37370265, 1744.69868201,
        1744.31447072, 1738.00189009, 1737.44664991, 1743.29873068,
        1751.32738586, 1751.28990836, 1755.97842939, 1760.61976342,
        1757.16754979, 1757.5138254 , 1756.79254623, 1753.60742154,
        1753.87360768, 1745.24310656, 1749.88228923, 1751.38610536,
        1751.91470923, 1752.87014376, 1758.89368375, 1764.46946248,
        1764.67130059, 1761.36293496, 1761.07258781, 1761.51061018,
        1754.8965018 , 1759.05449841, 1756.58386441, 1762.56678257,
        1762.0796674 , 1764.99080512, 1770.65150061, 1775.13202859,
        1777.30784827, 1773.04776737, 1777.27165183, 1772.64454395,
        1763.51659106, 1759.20509399, 1760.0965912 , 1770.27061334,
        1769.18299821, 1771.52598201, 1773.33853354, 1777.06349998,
...
        1797.05505371, 1799.97424316, 1808.69580078, 1814.59033203,
        1816.27026367, 1818.09460449, 1821.98181152, 1828.12536621,
        1827.02172852, 1825.64221191, 1823.13452148, 1818.86352539,
        1813.2286377 , 1813.99377441, 1818.28430176, 1822.51599121,
        1823.63964844, 1825.46923828, 1829.46435547, 1835.49145508,
        1832.17175293, 1832.43701172, 1829.03051758, 1820.9465332 ,
        1816.70385742, 1817.13110352, 1819.75500488, 1824.69995117,
        1827.83312988, 1831.61486816, 1835.17346191, 1837.74914551,
        1839.8157959 , 1839.44677734, 1839.34716797, 1833.76525879,
        1829.28649902, 1830.94006348, 1834.95019531, 1836.88171387,
        1837.10400391, 1836.77282715, 1840.90698242, 1844.97924805,
        1840.29821777, 1838.35668945, 1835.8034668 , 1834.19641113,
        1828.58569336, 1827.65136719, 1831.88330078, 1838.01965332,
        1840.49108887, 1842.46264648, 1843.26342773, 1847.15710449,
        1849.97814941, 1845.48986816, 1844.07312012, 1841.04187012,
        1837.9029541 , 1838.42004395, 1841.79199219, 1846.53442383,
        1851.36230469, 1854.37402344, 1855.06762695, 1857.03173828,
                  nan,           nan,           nan,           nan,
                  nan,           nan,           nan,           nan,
                  nan,           nan,           nan,           nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>xco2</span></div><div class='xr-var-dims'>(product, time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>375.8 376.5 376.4 ... nan nan nan</div><input id='attrs-61fd4018-d5fe-4d93-acf1-32c263e4cdd9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-61fd4018-d5fe-4d93-acf1-32c263e4cdd9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-29a27ec1-7edd-45f4-8ded-67bd707e7dab' class='xr-var-data-in' type='checkbox'><label for='data-29a27ec1-7edd-45f4-8ded-67bd707e7dab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[375.79783532, 376.46407914, 376.41277205, 376.17348009,
        375.8472341 , 375.07333385, 372.79371437, 371.45940443,
        372.30523034, 373.79839484, 374.98417492, 375.65089776,
        376.55476436, 376.84431328, 377.60942875, 377.57614609,
        377.90475037, 377.20246374, 374.75551576, 373.41393415,
        373.71579377, 374.8435099 , 375.97927652, 377.03936425,
        377.98902108, 378.40465777, 379.36143682, 379.67497303,
        379.71434566, 378.88811201, 376.41132851, 375.65575217,
        376.01882869, 377.38643566, 378.35233524, 379.30174629,
        380.1081556 , 381.53149172, 381.21065402, 381.96521566,
        381.8338032 , 380.96487594, 378.81812456, 377.9374302 ,
        378.24196999, 379.45376219, 380.51828661, 381.37530676,
        382.29416804, 383.21714685, 383.66844393, 384.03110141,
        384.03189604, 383.00207675, 381.20253983, 380.20700488,
        380.37287932, 381.49399998, 382.61658501, 383.7534259 ,
        384.89001568, 385.46126062, 386.22357291, 386.18869069,
        386.23539343, 385.18362739, 383.14084697, 382.63596141,
        382.48581615, 383.77796058, 384.78026247, 385.26383585,
        386.23487559, 386.92342105, 387.58630842, 387.29054613,
        387.31455521, 386.50734321, 384.70412995, 383.66520007,
...
        400.11514282, 399.43743896, 398.18374634, 397.28027344,
        397.54452515, 398.36392212, 399.52120972, 400.55776978,
        401.28369141, 401.78469849, 402.44311523, 403.15982056,
        403.40612793, 402.81607056, 401.28613281, 400.2192688 ,
        400.30474854, 401.07980347, 402.08770752, 402.99093628,
        403.57345581, 403.99133301, 404.4571228 , 405.07318115,
        405.25259399, 404.5786438 , 403.0395813 , 401.98565674,
        402.10061646, 402.89254761, 403.88265991, 404.82241821,
        405.40560913, 405.89849854, 406.46661377, 407.16571045,
        407.41574097, 406.87194824, 405.46936035, 404.36141968,
        404.2628479 , 405.00170898, 406.09042358, 406.93869019,
        407.6088562 , 408.16314697, 408.81744385, 409.52008057,
        409.9239502 , 409.61090088, 408.71209717, 408.00125122,
        408.3838501 , 409.28442383, 410.3399353 , 411.25372314,
        411.97491455, 412.38336182, 412.95114136, 413.54464722,
        413.79187012, 413.41329956, 412.31512451, 411.67501831,
        412.05978394, 412.9473877 , 413.89126587, 414.75424194,
                 nan,          nan,          nan,          nan,
                 nan,          nan,          nan,          nan,
                 nan,          nan,          nan,          nan]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a7099f90-ea12-4518-b25f-62da920bd4e4' class='xr-section-summary-in' type='checkbox'  ><label for='section-a7099f90-ea12-4518-b25f-62da920bd4e4' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7a9bab77-54f9-46ee-b211-618ee3f450c0' class='xr-index-data-in' type='checkbox'/><label for='index-7a9bab77-54f9-46ee-b211-618ee3f450c0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2003-01-01&#x27;, &#x27;2003-02-01&#x27;, &#x27;2003-03-01&#x27;, &#x27;2003-04-01&#x27;,
               &#x27;2003-05-01&#x27;, &#x27;2003-06-01&#x27;, &#x27;2003-07-01&#x27;, &#x27;2003-08-01&#x27;,
               &#x27;2003-09-01&#x27;, &#x27;2003-10-01&#x27;,
               ...
               &#x27;2021-03-01&#x27;, &#x27;2021-04-01&#x27;, &#x27;2021-05-01&#x27;, &#x27;2021-06-01&#x27;,
               &#x27;2021-07-01&#x27;, &#x27;2021-08-01&#x27;, &#x27;2021-09-01&#x27;, &#x27;2021-10-01&#x27;,
               &#x27;2021-11-01&#x27;, &#x27;2021-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=228, freq=&#x27;MS&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>product</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-95ff2483-cd2e-416e-ab7c-538d394ca50b' class='xr-index-data-in' type='checkbox'/><label for='index-95ff2483-cd2e-416e-ab7c-538d394ca50b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;satellites&#x27;, &#x27;reanalysis&#x27;], dtype=&#x27;object&#x27;, name=&#x27;product&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8e994152-f4ee-4a78-b082-c052e31e95d0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8e994152-f4ee-4a78-b082-c052e31e95d0' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i_abc</span><span class="p">,</span> <span class="n">i_ax</span><span class="p">,</span> <span class="n">i_dom</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ABC</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">ghg_both_datasets</span><span class="o">.</span><span class="n">ghg</span><span class="p">):</span>
    <span class="n">subtitle</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">i_abc</span><span class="si">}</span><span class="s1">) </span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="n">i_dom</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="n">i_dom</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()][</span><span class="s2">&quot;shortname&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span>
    <span class="n">y_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Colunn-averaged </span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="n">i_dom</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()][</span><span class="s2">&quot;shortname&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> [</span><span class="si">{</span><span class="n">aux_var</span><span class="p">[</span><span class="n">i_dom</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()][</span><span class="s2">&quot;units&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">]&#39;</span>
    <span class="n">ghg_both_datasets</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">ghg</span><span class="o">=</span><span class="n">i_dom</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;product&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">i_ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">ghg_both_datasets</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

    <span class="n">i_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">subtitle</span><span class="p">)</span>
    <span class="n">i_ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">i_ax</span><span class="p">,</span> <span class="n">trim</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">i_ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%Y&#39;</span><span class="p">))</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ba0ca286139b77530981405ae746d2b2b516a59b93642fbad0c267150e9a79b9.png" src="../_images/ba0ca286139b77530981405ae746d2b2b516a59b93642fbad0c267150e9a79b9.png" />
</div>
</div>
<p>Both satellites and reanalysis data indicate the strong increasing trend for both GHG, with the trend being of similar magnitude.</br>
At the same time we can observe some differences:</br>
For the CO2 data the differences are mainly in the magnitude of the concentrations for around the first half of the data (2003-2013). For the CH4 though, the differences are more substantial, and for most of the analysed period. These differences can be related to the methodology for generating the products, and the fact that satellite data are not complete in space and time, so there could be important information omitted.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./01_greenhouse_gases"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Sketchbook Earth: Illustrated Climate Chronicles</p>
      </div>
    </a>
    <a class="right-next"
       href="../02_temperature/02_temperature.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 2: It’s getting hot in here…</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generation-of-plots-based-on-the-relevant-climate-indicators-report">Generation of plots based on the relevant Climate Indicators’ report.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-1-install-import-the-necessary-packages">Section 1. Install &amp; import the necessary packages.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-2-download-data-from-cds">Section 2. Download data from CDS.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-3-calculate-the-ghg-concentrations-and-growth-rates">Section 3. Calculate the GHG concentrations and growth rates</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#focus-on-sub-polar-regions">Focus on sub-polar regions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temporal-smoothing">Temporal smoothing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-average">Spatial average</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annnual-growth-rates">Annnual growth rates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uncertainty-estimates-of-growth-rates">Uncertainty estimates of growth rates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-evolution-of-ghg-concentration-and-growth-rates">Plot the evolution of GHG concentration and growth rates.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-co2-with-ch4">Comparing CO2 with CH4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regional-spatial-averages">Regional spatial averages</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-4-useful-links">Section 4. Useful links</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#appendices">Appendices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-a-monthly-climatology-of-the-variables">Appendix A: Monthly climatology of the variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-b-using-reanalysis-data-available-at-the-atmopshere-data-store-ads">Appendix B: Using reanalysis data available at the Atmopshere Data Store (ADS)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Niclas Rieger, Nikolaos Mastrantonas
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>